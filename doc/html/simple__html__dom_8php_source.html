<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Nina:  Fichier source de /home/damien/www/nina/extensions/XMLDataSource/lib/simple_html_dom.php</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Nina
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Généré par Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Recherche');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Page&#160;principale</span></a></li>
      <li><a href="namespaces.html"><span>Espaces&#160;de&#160;nommage</span></a></li>
      <li><a href="annotated.html"><span>Structures&#160;de&#160;données</span></a></li>
      <li class="current"><a href="files.html"><span>Fichiers</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Recherche" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>Liste&#160;des&#160;fichiers</span></a></li>
      <li><a href="globals.html"><span>Variables&#160;globale</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('simple__html__dom_8php.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">/home/damien/www/nina/extensions/XMLDataSource/lib/simple_html_dom.php</div>  </div>
</div><!--header-->
<div class="contents">
<a href="simple__html__dom_8php.html">Aller à la documentation de ce fichier.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00042"></a><a class="code" href="simple__html__dom_8php.html#ae4ed40ab10a6b4194cfc3114bd3902a2">00042</a> define(<span class="stringliteral">&#39;HDOM_TYPE_ELEMENT&#39;</span>, 1);
<a name="l00043"></a><a class="code" href="simple__html__dom_8php.html#a150eac2dfb509c2e71c53f1a1dbde7ab">00043</a> define(<span class="stringliteral">&#39;HDOM_TYPE_COMMENT&#39;</span>, 2);
<a name="l00044"></a><a class="code" href="simple__html__dom_8php.html#a5918dbd4526d477e5fe865f333e9538c">00044</a> define(<span class="stringliteral">&#39;HDOM_TYPE_TEXT&#39;</span>,    3);
<a name="l00045"></a><a class="code" href="simple__html__dom_8php.html#a741ba1a55baf1b9d1ecb1f85e2627ef8">00045</a> define(<span class="stringliteral">&#39;HDOM_TYPE_ENDTAG&#39;</span>,  4);
<a name="l00046"></a><a class="code" href="simple__html__dom_8php.html#a5a01433d1f7448627983b4210646875a">00046</a> define(<span class="stringliteral">&#39;HDOM_TYPE_ROOT&#39;</span>,    5);
<a name="l00047"></a><a class="code" href="simple__html__dom_8php.html#a9b8b189e64f2ed2f007a3733ac6b92d2">00047</a> define(<span class="stringliteral">&#39;HDOM_TYPE_UNKNOWN&#39;</span>, 6);
<a name="l00048"></a><a class="code" href="simple__html__dom_8php.html#a25b2e9df879f0e9e6c19a2b1a0560270">00048</a> define(<span class="stringliteral">&#39;HDOM_QUOTE_DOUBLE&#39;</span>, 0);
<a name="l00049"></a><a class="code" href="simple__html__dom_8php.html#a6c2fdccdefefb69968227c6c3ec6611a">00049</a> define(<span class="stringliteral">&#39;HDOM_QUOTE_SINGLE&#39;</span>, 1);
<a name="l00050"></a><a class="code" href="simple__html__dom_8php.html#ad587bc18546aacd6ec20b68dc1ef9379">00050</a> define(<span class="stringliteral">&#39;HDOM_QUOTE_NO&#39;</span>,     3);
<a name="l00051"></a><a class="code" href="simple__html__dom_8php.html#a18bc2baf215f9fa2889795e860e30a8f">00051</a> define(<span class="stringliteral">&#39;HDOM_INFO_BEGIN&#39;</span>,   0);
<a name="l00052"></a><a class="code" href="simple__html__dom_8php.html#a13c34186f5e8fa871944f1d39f893ca4">00052</a> define(<span class="stringliteral">&#39;HDOM_INFO_END&#39;</span>,     1);
<a name="l00053"></a><a class="code" href="simple__html__dom_8php.html#a1b5b6bdcc0c5597e0e9f0f881ff9ab3c">00053</a> define(<span class="stringliteral">&#39;HDOM_INFO_QUOTE&#39;</span>,   2);
<a name="l00054"></a><a class="code" href="simple__html__dom_8php.html#a05a5288384d1d6deb25e6b5cb67eba9b">00054</a> define(<span class="stringliteral">&#39;HDOM_INFO_SPACE&#39;</span>,   3);
<a name="l00055"></a><a class="code" href="simple__html__dom_8php.html#a9750656802ea115d7b3797e22cf2f07e">00055</a> define(<span class="stringliteral">&#39;HDOM_INFO_TEXT&#39;</span>,    4);
<a name="l00056"></a><a class="code" href="simple__html__dom_8php.html#aabbc85c183b84f80d434add6347dd7fd">00056</a> define(<span class="stringliteral">&#39;HDOM_INFO_INNER&#39;</span>,   5);
<a name="l00057"></a><a class="code" href="simple__html__dom_8php.html#a008676ca7c003de95f7e6ea6ff92a63b">00057</a> define(<span class="stringliteral">&#39;HDOM_INFO_OUTER&#39;</span>,   6);
<a name="l00058"></a><a class="code" href="simple__html__dom_8php.html#a886a1a55b0a5ea6c66e0eff6fdea87bc">00058</a> define(<span class="stringliteral">&#39;HDOM_INFO_ENDSPACE&#39;</span>,7);
<a name="l00059"></a><a class="code" href="simple__html__dom_8php.html#a68caecf7e025598ca05828747d2952e9">00059</a> define(<span class="stringliteral">&#39;DEFAULT_TARGET_CHARSET&#39;</span>, <span class="stringliteral">&#39;UTF-8&#39;</span>);
<a name="l00060"></a><a class="code" href="simple__html__dom_8php.html#af934fcb7094d73cbf2d81fe142915c07">00060</a> define(<span class="stringliteral">&#39;DEFAULT_BR_TEXT&#39;</span>, <span class="stringliteral">&quot;\r\n&quot;</span>);
<a name="l00061"></a>00061 <span class="comment">// helper functions</span>
<a name="l00062"></a>00062 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l00063"></a>00063 <span class="comment">// get html dom from file</span>
<a name="l00064"></a>00064 <span class="comment">// $maxlen is defined in the code as PHP_STREAM_COPY_ALL which is defined as -1.</span>
<a name="l00065"></a><a class="code" href="simple__html__dom_8php.html#ac2d9d7ae135e915c7221620d8dd9a20d">00065</a> <span class="keyword">function</span> <a class="code" href="simple__html__dom_8php.html#ac2d9d7ae135e915c7221620d8dd9a20d">file_get_html</a>($url, $use_include_path = <span class="keyword">false</span>, $context=null, $offset = -1, $maxLen=-1, $lowercase = <span class="keyword">true</span>, $forceTagsClosed=<span class="keyword">true</span>, $target_charset = <a class="code" href="simple__html__dom_8php.html#a68caecf7e025598ca05828747d2952e9">DEFAULT_TARGET_CHARSET</a>, $stripRN=<span class="keyword">true</span>, $defaultBRText=<a class="code" href="simple__html__dom_8php.html#af934fcb7094d73cbf2d81fe142915c07">DEFAULT_BR_TEXT</a>)
<a name="l00066"></a>00066 {
<a name="l00067"></a>00067     <span class="comment">// We DO force the tags to be terminated.</span>
<a name="l00068"></a>00068     $dom = <span class="keyword">new</span> <a class="code" href="classsimple__html__dom.html">simple_html_dom</a>(null, $lowercase, $forceTagsClosed, $target_charset, $defaultBRText);
<a name="l00069"></a>00069     <span class="comment">// For sourceforge users: uncomment the next line and comment the retreive_url_contents line 2 lines down if it is not already done.</span>
<a name="l00070"></a>00070     $contents = file_get_contents($url, $use_include_path, $context, $offset);
<a name="l00071"></a>00071     <span class="comment">// Paperg - use our own mechanism for getting the contents as we want to control the timeout.</span>
<a name="l00072"></a>00072 <span class="comment">//    $contents = retrieve_url_contents($url);</span>
<a name="l00073"></a>00073     <span class="keywordflow">if</span> (empty($contents))
<a name="l00074"></a>00074     {
<a name="l00075"></a>00075         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00076"></a>00076     }
<a name="l00077"></a>00077     <span class="comment">// The second parameter can force the selectors to all be lowercase.</span>
<a name="l00078"></a>00078     $dom-&gt;load($contents, $lowercase, $stripRN);
<a name="l00079"></a>00079     <span class="keywordflow">return</span> $dom;
<a name="l00080"></a>00080 }
<a name="l00081"></a>00081 
<a name="l00082"></a>00082 <span class="comment">// get html dom from string</span>
<a name="l00083"></a><a class="code" href="simple__html__dom_8php.html#a450a050ad06a68189f7808201067a22e">00083</a> <span class="keyword">function</span> <a class="code" href="simple__html__dom_8php.html#a450a050ad06a68189f7808201067a22e">str_get_html</a>($str, $lowercase=<span class="keyword">true</span>, $forceTagsClosed=<span class="keyword">true</span>, $target_charset = <a class="code" href="simple__html__dom_8php.html#a68caecf7e025598ca05828747d2952e9">DEFAULT_TARGET_CHARSET</a>, $stripRN=<span class="keyword">true</span>, $defaultBRText=<a class="code" href="simple__html__dom_8php.html#af934fcb7094d73cbf2d81fe142915c07">DEFAULT_BR_TEXT</a>)
<a name="l00084"></a>00084 {
<a name="l00085"></a>00085     $dom = <span class="keyword">new</span> <a class="code" href="classsimple__html__dom.html">simple_html_dom</a>(null, $lowercase, $forceTagsClosed, $target_charset, $defaultBRText);
<a name="l00086"></a>00086     <span class="keywordflow">if</span> (empty($str))
<a name="l00087"></a>00087     {
<a name="l00088"></a>00088         $dom-&gt;clear();
<a name="l00089"></a>00089         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00090"></a>00090     }
<a name="l00091"></a>00091     $dom-&gt;load($str, $lowercase, $stripRN);
<a name="l00092"></a>00092     <span class="keywordflow">return</span> $dom;
<a name="l00093"></a>00093 }
<a name="l00094"></a>00094 
<a name="l00095"></a>00095 <span class="comment">// dump html dom tree</span>
<a name="l00096"></a><a class="code" href="simple__html__dom_8php.html#a1f67414b1908776b16f3fc8c6953c13f">00096</a> <span class="keyword">function</span> <a class="code" href="simple__html__dom_8php.html#a1f67414b1908776b16f3fc8c6953c13f">dump_html_tree</a>($node, $show_attr=<span class="keyword">true</span>, $deep=0)
<a name="l00097"></a>00097 {
<a name="l00098"></a>00098     $node-&gt;dump($node);
<a name="l00099"></a>00099 }
<a name="l00100"></a>00100 
<a name="l00108"></a><a class="code" href="classsimple__html__dom__node.html">00108</a> <span class="keyword">class </span><a class="code" href="classsimple__html__dom__node.html">simple_html_dom_node</a> {
<a name="l00109"></a><a class="code" href="classsimple__html__dom__node.html#abc1baa5da51bb7404ed787754af7e28b">00109</a>     <span class="keyword">public</span> <a class="code" href="classsimple__html__dom__node.html#abc1baa5da51bb7404ed787754af7e28b">$nodetype</a> = <a class="code" href="simple__html__dom_8php.html#a5918dbd4526d477e5fe865f333e9538c">HDOM_TYPE_TEXT</a>;
<a name="l00110"></a><a class="code" href="classsimple__html__dom__node.html#a81d5015d41ed8ec66e9db8cdc5db9555">00110</a>     <span class="keyword">public</span> <a class="code" href="classsimple__html__dom__node.html#a81d5015d41ed8ec66e9db8cdc5db9555">$tag</a> = <span class="stringliteral">&#39;text&#39;</span>;
<a name="l00111"></a><a class="code" href="classsimple__html__dom__node.html#a0b41385738b43ee6b8668650e7a4c990">00111</a>     <span class="keyword">public</span> <a class="code" href="classsimple__html__dom__node.html#a0b41385738b43ee6b8668650e7a4c990">$attr</a> = array();
<a name="l00112"></a><a class="code" href="classsimple__html__dom__node.html#aafda1a84fe840800c9884c167093f759">00112</a>     <span class="keyword">public</span> <a class="code" href="classsimple__html__dom__node.html#aafda1a84fe840800c9884c167093f759">$children</a> = array();
<a name="l00113"></a><a class="code" href="classsimple__html__dom__node.html#afc84f46342a660cca8589570197bc421">00113</a>     <span class="keyword">public</span> <a class="code" href="classsimple__html__dom__node.html#afc84f46342a660cca8589570197bc421">$nodes</a> = array();
<a name="l00114"></a><a class="code" href="classsimple__html__dom__node.html#a4e2313a4b35b72a06ac45fd38960f677">00114</a>     <span class="keyword">public</span> <a class="code" href="classsimple__html__dom__node.html#a4e2313a4b35b72a06ac45fd38960f677">$parent</a> = null;
<a name="l00115"></a><a class="code" href="classsimple__html__dom__node.html#a4d36a5af9eae86547e70574573b45f33">00115</a>     <span class="keyword">public</span> <a class="code" href="classsimple__html__dom__node.html#a4d36a5af9eae86547e70574573b45f33">$_</a> = array();
<a name="l00116"></a><a class="code" href="classsimple__html__dom__node.html#af1af90d3ddaae5df362bdbfa7a5eb7e4">00116</a>     <span class="keyword">public</span> <a class="code" href="classsimple__html__dom__node.html#af1af90d3ddaae5df362bdbfa7a5eb7e4">$tag_start</a> = 0;
<a name="l00117"></a>00117     <span class="keyword">private</span> $dom = null;
<a name="l00118"></a>00118 
<a name="l00119"></a><a class="code" href="classsimple__html__dom__node.html#aac23fa1150ef19e7f28c0cf2d9e31086">00119</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#aac23fa1150ef19e7f28c0cf2d9e31086">__construct</a>($dom)
<a name="l00120"></a>00120     {
<a name="l00121"></a>00121         $this-&gt;dom = $dom;
<a name="l00122"></a>00122         $dom-&gt;nodes[] = $this;
<a name="l00123"></a>00123     }
<a name="l00124"></a>00124 
<a name="l00125"></a><a class="code" href="classsimple__html__dom__node.html#a421831a265621325e1fdd19aace0c758">00125</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a421831a265621325e1fdd19aace0c758">__destruct</a>()
<a name="l00126"></a>00126     {
<a name="l00127"></a>00127         $this-&gt;<a class="code" href="classsimple__html__dom__node.html#aa821bec12eaa7e0f649397c9675ff505">clear</a>();
<a name="l00128"></a>00128     }
<a name="l00129"></a>00129 
<a name="l00130"></a><a class="code" href="classsimple__html__dom__node.html#a7516ca30af0db3cdbf9a7739b48ce91d">00130</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a7516ca30af0db3cdbf9a7739b48ce91d">__toString</a>()
<a name="l00131"></a>00131     {
<a name="l00132"></a>00132         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a64d25961093a3b4c7b9b26a6d56c5831">outertext</a>();
<a name="l00133"></a>00133     }
<a name="l00134"></a>00134 
<a name="l00135"></a>00135     <span class="comment">// clean up memory due to php5 circular references memory leak...</span>
<a name="l00136"></a><a class="code" href="classsimple__html__dom__node.html#aa821bec12eaa7e0f649397c9675ff505">00136</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#aa821bec12eaa7e0f649397c9675ff505">clear</a>()
<a name="l00137"></a>00137     {
<a name="l00138"></a>00138         $this-&gt;dom = null;
<a name="l00139"></a>00139         $this-&gt;nodes = null;
<a name="l00140"></a>00140         $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a3249177749c4f2274ed77044179f7f6b">parent</a> = null;
<a name="l00141"></a>00141         $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a42d02529839611cba362c6b5ce58f719">children</a> = null;
<a name="l00142"></a>00142     }
<a name="l00143"></a>00143 
<a name="l00144"></a>00144     <span class="comment">// dump node&#39;s tree</span>
<a name="l00145"></a><a class="code" href="classsimple__html__dom__node.html#ad15ceec0aa0d3e1c5ca8c7bd6aebe80b">00145</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#ad15ceec0aa0d3e1c5ca8c7bd6aebe80b">dump</a>($show_attr=<span class="keyword">true</span>, $deep=0)
<a name="l00146"></a>00146     {
<a name="l00147"></a>00147         $lead = str_repeat(<span class="stringliteral">&#39;    &#39;</span>, $deep);
<a name="l00148"></a>00148 
<a name="l00149"></a>00149         echo $lead.$this-&gt;tag;
<a name="l00150"></a>00150         <span class="keywordflow">if</span> ($show_attr &amp;&amp; count($this-&gt;attr)&gt;0)
<a name="l00151"></a>00151         {
<a name="l00152"></a>00152             echo <span class="charliteral">&#39;(&#39;</span>;
<a name="l00153"></a>00153             <span class="keywordflow">foreach</span> ($this-&gt;attr as $k=&gt;$v)
<a name="l00154"></a>00154                 echo <span class="stringliteral">&quot;[$k]=&gt;\&quot;&quot;</span>.$this-&gt;$k.<span class="stringliteral">&#39;&quot;, &#39;</span>;
<a name="l00155"></a>00155             echo <span class="charliteral">&#39;)&#39;</span>;
<a name="l00156"></a>00156         }
<a name="l00157"></a>00157         echo <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00158"></a>00158 
<a name="l00159"></a>00159         <span class="keywordflow">foreach</span> ($this-&gt;nodes as $c)
<a name="l00160"></a>00160             $c-&gt;dump($show_attr, $deep+1);
<a name="l00161"></a>00161     }
<a name="l00162"></a>00162 
<a name="l00163"></a>00163 
<a name="l00164"></a>00164     <span class="comment">// Debugging function to dump a single dom node with a bunch of information about it.</span>
<a name="l00165"></a><a class="code" href="classsimple__html__dom__node.html#ac39e34429239873f30e8893279386b6e">00165</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#ac39e34429239873f30e8893279386b6e">dump_node</a>()
<a name="l00166"></a>00166     {
<a name="l00167"></a>00167         echo $this-&gt;tag;
<a name="l00168"></a>00168         <span class="keywordflow">if</span> (count($this-&gt;attr)&gt;0)
<a name="l00169"></a>00169         {
<a name="l00170"></a>00170             echo <span class="charliteral">&#39;(&#39;</span>;
<a name="l00171"></a>00171             <span class="keywordflow">foreach</span> ($this-&gt;attr as $k=&gt;$v)
<a name="l00172"></a>00172             {
<a name="l00173"></a>00173                 echo <span class="stringliteral">&quot;[$k]=&gt;\&quot;&quot;</span>.$this-&gt;$k.<span class="stringliteral">&#39;&quot;, &#39;</span>;
<a name="l00174"></a>00174             }
<a name="l00175"></a>00175             echo <span class="charliteral">&#39;)&#39;</span>;
<a name="l00176"></a>00176         }
<a name="l00177"></a>00177         <span class="keywordflow">if</span> (count($this-&gt;attr)&gt;0)
<a name="l00178"></a>00178         {
<a name="l00179"></a>00179             echo <span class="stringliteral">&#39; $_ (&#39;</span>;
<a name="l00180"></a>00180             <span class="keywordflow">foreach</span> ($this-&gt;_ as $k=&gt;$v)
<a name="l00181"></a>00181             {
<a name="l00182"></a>00182                 <span class="keywordflow">if</span> (is_array($v))
<a name="l00183"></a>00183                 {
<a name="l00184"></a>00184                     echo <span class="stringliteral">&quot;[$k]=&gt;(&quot;</span>;
<a name="l00185"></a>00185                     <span class="keywordflow">foreach</span> ($v as $k2=&gt;$v2)
<a name="l00186"></a>00186                     {
<a name="l00187"></a>00187                         echo <span class="stringliteral">&quot;[$k2]=&gt;\&quot;&quot;</span>.$v2.<span class="stringliteral">&#39;&quot;, &#39;</span>;
<a name="l00188"></a>00188                     }
<a name="l00189"></a>00189                     echo <span class="stringliteral">&quot;)&quot;</span>;
<a name="l00190"></a>00190                 } <span class="keywordflow">else</span> {
<a name="l00191"></a>00191                     echo <span class="stringliteral">&quot;[$k]=&gt;\&quot;&quot;</span>.$v.<span class="stringliteral">&#39;&quot;, &#39;</span>;
<a name="l00192"></a>00192                 }
<a name="l00193"></a>00193             }
<a name="l00194"></a>00194             echo <span class="stringliteral">&quot;)&quot;</span>;
<a name="l00195"></a>00195         }
<a name="l00196"></a>00196 
<a name="l00197"></a>00197         <span class="keywordflow">if</span> (isset($this-&gt;<a class="code" href="classsimple__html__dom__node.html#a37df362c2f77a0045fa8af094f432238">text</a>))
<a name="l00198"></a>00198         {
<a name="l00199"></a>00199             echo <span class="stringliteral">&quot; text: (&quot;</span> . $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a37df362c2f77a0045fa8af094f432238">text</a> . <span class="stringliteral">&quot;)&quot;</span>;
<a name="l00200"></a>00200         }
<a name="l00201"></a>00201 
<a name="l00202"></a>00202         echo <span class="stringliteral">&quot; children: &quot;</span> . count($this-&gt;<a class="code" href="classsimple__html__dom__node.html#a42d02529839611cba362c6b5ce58f719">children</a>);
<a name="l00203"></a>00203         echo <span class="stringliteral">&quot; nodes: &quot;</span> . count($this-&gt;nodes);
<a name="l00204"></a>00204         echo <span class="stringliteral">&quot; tag_start: &quot;</span> . $this-&gt;tag_start;
<a name="l00205"></a>00205         echo <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00206"></a>00206 
<a name="l00207"></a>00207     }
<a name="l00208"></a>00208 
<a name="l00209"></a>00209     <span class="comment">// returns the parent of node</span>
<a name="l00210"></a><a class="code" href="classsimple__html__dom__node.html#a3249177749c4f2274ed77044179f7f6b">00210</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a3249177749c4f2274ed77044179f7f6b">parent</a>()
<a name="l00211"></a>00211     {
<a name="l00212"></a>00212         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a3249177749c4f2274ed77044179f7f6b">parent</a>;
<a name="l00213"></a>00213     }
<a name="l00214"></a>00214 
<a name="l00215"></a>00215     <span class="comment">// returns children of node</span>
<a name="l00216"></a><a class="code" href="classsimple__html__dom__node.html#a42d02529839611cba362c6b5ce58f719">00216</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a42d02529839611cba362c6b5ce58f719">children</a>($idx=-1)
<a name="l00217"></a>00217     {
<a name="l00218"></a>00218         <span class="keywordflow">if</span> ($idx===-1) <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a42d02529839611cba362c6b5ce58f719">children</a>;
<a name="l00219"></a>00219         <span class="keywordflow">if</span> (isset($this-&gt;<a class="code" href="classsimple__html__dom__node.html#a42d02529839611cba362c6b5ce58f719">children</a>[$idx])) <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a42d02529839611cba362c6b5ce58f719">children</a>[$idx];
<a name="l00220"></a>00220         <span class="keywordflow">return</span> null;
<a name="l00221"></a>00221     }
<a name="l00222"></a>00222 
<a name="l00223"></a>00223     <span class="comment">// returns the first child of node</span>
<a name="l00224"></a><a class="code" href="classsimple__html__dom__node.html#ade851eb21476ec16857ed56d166f6afc">00224</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#ade851eb21476ec16857ed56d166f6afc">first_child</a>()
<a name="l00225"></a>00225     {
<a name="l00226"></a>00226         <span class="keywordflow">if</span> (count($this-&gt;<a class="code" href="classsimple__html__dom__node.html#a42d02529839611cba362c6b5ce58f719">children</a>)&gt;0) <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a42d02529839611cba362c6b5ce58f719">children</a>[0];
<a name="l00227"></a>00227         <span class="keywordflow">return</span> null;
<a name="l00228"></a>00228     }
<a name="l00229"></a>00229 
<a name="l00230"></a>00230     <span class="comment">// returns the last child of node</span>
<a name="l00231"></a><a class="code" href="classsimple__html__dom__node.html#a97160a76243a59b48b26e6d96b07b6ea">00231</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a97160a76243a59b48b26e6d96b07b6ea">last_child</a>()
<a name="l00232"></a>00232     {
<a name="l00233"></a>00233         <span class="keywordflow">if</span> (($count=count($this-&gt;<a class="code" href="classsimple__html__dom__node.html#a42d02529839611cba362c6b5ce58f719">children</a>))&gt;0) <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a42d02529839611cba362c6b5ce58f719">children</a>[$count-1];
<a name="l00234"></a>00234         <span class="keywordflow">return</span> null;
<a name="l00235"></a>00235     }
<a name="l00236"></a>00236 
<a name="l00237"></a>00237     <span class="comment">// returns the next sibling of node</span>
<a name="l00238"></a><a class="code" href="classsimple__html__dom__node.html#ade0fb39187948a5a6772dfc30252f8f8">00238</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#ade0fb39187948a5a6772dfc30252f8f8">next_sibling</a>()
<a name="l00239"></a>00239     {
<a name="l00240"></a>00240         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classsimple__html__dom__node.html#a3249177749c4f2274ed77044179f7f6b">parent</a>===null) <span class="keywordflow">return</span> null;
<a name="l00241"></a>00241         $idx = 0;
<a name="l00242"></a>00242         $count = count($this-&gt;<a class="code" href="classsimple__html__dom__node.html#a3249177749c4f2274ed77044179f7f6b">parent</a>-&gt;children);
<a name="l00243"></a>00243         <span class="keywordflow">while</span> ($idx&lt;$count &amp;&amp; $this!==$this-&gt;<a class="code" href="classsimple__html__dom__node.html#a3249177749c4f2274ed77044179f7f6b">parent</a>-&gt;children[$idx])
<a name="l00244"></a>00244             ++$idx;
<a name="l00245"></a>00245         <span class="keywordflow">if</span> (++$idx&gt;=$count) <span class="keywordflow">return</span> null;
<a name="l00246"></a>00246         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a3249177749c4f2274ed77044179f7f6b">parent</a>-&gt;children[$idx];
<a name="l00247"></a>00247     }
<a name="l00248"></a>00248 
<a name="l00249"></a>00249     <span class="comment">// returns the previous sibling of node</span>
<a name="l00250"></a><a class="code" href="classsimple__html__dom__node.html#acea92e7c0be16e44d15cc502cec229d8">00250</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#acea92e7c0be16e44d15cc502cec229d8">prev_sibling</a>()
<a name="l00251"></a>00251     {
<a name="l00252"></a>00252         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classsimple__html__dom__node.html#a3249177749c4f2274ed77044179f7f6b">parent</a>===null) <span class="keywordflow">return</span> null;
<a name="l00253"></a>00253         $idx = 0;
<a name="l00254"></a>00254         $count = count($this-&gt;<a class="code" href="classsimple__html__dom__node.html#a3249177749c4f2274ed77044179f7f6b">parent</a>-&gt;children);
<a name="l00255"></a>00255         <span class="keywordflow">while</span> ($idx&lt;$count &amp;&amp; $this!==$this-&gt;<a class="code" href="classsimple__html__dom__node.html#a3249177749c4f2274ed77044179f7f6b">parent</a>-&gt;children[$idx])
<a name="l00256"></a>00256             ++$idx;
<a name="l00257"></a>00257         <span class="keywordflow">if</span> (--$idx&lt;0) <span class="keywordflow">return</span> null;
<a name="l00258"></a>00258         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a3249177749c4f2274ed77044179f7f6b">parent</a>-&gt;children[$idx];
<a name="l00259"></a>00259     }
<a name="l00260"></a>00260 
<a name="l00261"></a>00261     <span class="comment">// function to locate a specific ancestor tag in the path to the root.</span>
<a name="l00262"></a><a class="code" href="classsimple__html__dom__node.html#a03d7c0efb45d013cc1421612c719e867">00262</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a03d7c0efb45d013cc1421612c719e867">find_ancestor_tag</a>(<a class="code" href="classsimple__html__dom__node.html#a81d5015d41ed8ec66e9db8cdc5db9555">$tag</a>)
<a name="l00263"></a>00263     {
<a name="l00264"></a>00264         global $debugObject;
<a name="l00265"></a>00265         <span class="keywordflow">if</span> (is_object($debugObject))
<a name="l00266"></a>00266         {
<a name="l00267"></a>00267             $debugObject-&gt;debugLogEntry(1);
<a name="l00268"></a>00268         }
<a name="l00269"></a>00269 
<a name="l00270"></a>00270         <span class="comment">// Start by including ourselves in the comparison.</span>
<a name="l00271"></a>00271         $returnDom = $this;
<a name="l00272"></a>00272 
<a name="l00273"></a>00273         <span class="keywordflow">while</span> (!is_null($returnDom))
<a name="l00274"></a>00274         {
<a name="l00275"></a>00275             <span class="keywordflow">if</span> (is_object($debugObject))
<a name="l00276"></a>00276             {
<a name="l00277"></a>00277                 $debugObject-&gt;debugLog(2, <span class="stringliteral">&quot;Current tag is: &quot;</span> . $returnDom-&gt;tag);
<a name="l00278"></a>00278             }
<a name="l00279"></a>00279 
<a name="l00280"></a>00280             <span class="keywordflow">if</span> ($returnDom-&gt;tag == <a class="code" href="classsimple__html__dom__node.html#a81d5015d41ed8ec66e9db8cdc5db9555">$tag</a>)
<a name="l00281"></a>00281             {
<a name="l00282"></a>00282                 <span class="keywordflow">break</span>;
<a name="l00283"></a>00283             }
<a name="l00284"></a>00284             $returnDom = $returnDom-&gt;parent;
<a name="l00285"></a>00285         }
<a name="l00286"></a>00286         <span class="keywordflow">return</span> $returnDom;
<a name="l00287"></a>00287     }
<a name="l00288"></a>00288 
<a name="l00289"></a>00289     <span class="comment">// get dom node&#39;s inner html</span>
<a name="l00290"></a><a class="code" href="classsimple__html__dom__node.html#a3791d55e93a3af992d58a3db23abab9b">00290</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a3791d55e93a3af992d58a3db23abab9b">innertext</a>()
<a name="l00291"></a>00291     {
<a name="l00292"></a>00292         <span class="keywordflow">if</span> (isset($this-&gt;_[<a class="code" href="simple__html__dom_8php.html#aabbc85c183b84f80d434add6347dd7fd">HDOM_INFO_INNER</a>])) <span class="keywordflow">return</span> $this-&gt;_[<a class="code" href="simple__html__dom_8php.html#aabbc85c183b84f80d434add6347dd7fd">HDOM_INFO_INNER</a>];
<a name="l00293"></a>00293         <span class="keywordflow">if</span> (isset($this-&gt;_[<a class="code" href="simple__html__dom_8php.html#a9750656802ea115d7b3797e22cf2f07e">HDOM_INFO_TEXT</a>])) <span class="keywordflow">return</span> $this-&gt;dom-&gt;restore_noise($this-&gt;_[HDOM_INFO_TEXT]);
<a name="l00294"></a>00294 
<a name="l00295"></a>00295         $ret = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00296"></a>00296         <span class="keywordflow">foreach</span> ($this-&gt;nodes as $n)
<a name="l00297"></a>00297             $ret .= $n-&gt;outertext();
<a name="l00298"></a>00298         <span class="keywordflow">return</span> $ret;
<a name="l00299"></a>00299     }
<a name="l00300"></a>00300 
<a name="l00301"></a>00301     <span class="comment">// get dom node&#39;s outer text (with tag)</span>
<a name="l00302"></a><a class="code" href="classsimple__html__dom__node.html#a64d25961093a3b4c7b9b26a6d56c5831">00302</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a64d25961093a3b4c7b9b26a6d56c5831">outertext</a>()
<a name="l00303"></a>00303     {
<a name="l00304"></a>00304         global $debugObject;
<a name="l00305"></a>00305         <span class="keywordflow">if</span> (is_object($debugObject))
<a name="l00306"></a>00306         {
<a name="l00307"></a>00307             $text = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00308"></a>00308             <span class="keywordflow">if</span> ($this-&gt;tag == <span class="stringliteral">&#39;text&#39;</span>)
<a name="l00309"></a>00309             {
<a name="l00310"></a>00310                 <span class="keywordflow">if</span> (!empty($this-&gt;<a class="code" href="classsimple__html__dom__node.html#a37df362c2f77a0045fa8af094f432238">text</a>))
<a name="l00311"></a>00311                 {
<a name="l00312"></a>00312                     $text = <span class="stringliteral">&quot; with text: &quot;</span> . $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a37df362c2f77a0045fa8af094f432238">text</a>;
<a name="l00313"></a>00313                 }
<a name="l00314"></a>00314             }
<a name="l00315"></a>00315             $debugObject-&gt;debugLog(1, <span class="stringliteral">&#39;Innertext of tag: &#39;</span> . $this-&gt;tag . $text);
<a name="l00316"></a>00316         }
<a name="l00317"></a>00317 
<a name="l00318"></a>00318         <span class="keywordflow">if</span> ($this-&gt;tag===<span class="stringliteral">&#39;root&#39;</span>) <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a3791d55e93a3af992d58a3db23abab9b">innertext</a>();
<a name="l00319"></a>00319 
<a name="l00320"></a>00320         <span class="comment">// trigger callback</span>
<a name="l00321"></a>00321         <span class="keywordflow">if</span> ($this-&gt;dom &amp;&amp; $this-&gt;dom-&gt;callback!==null)
<a name="l00322"></a>00322         {
<a name="l00323"></a>00323             call_user_func_array($this-&gt;dom-&gt;callback, array($this));
<a name="l00324"></a>00324         }
<a name="l00325"></a>00325 
<a name="l00326"></a>00326         <span class="keywordflow">if</span> (isset($this-&gt;_[<a class="code" href="simple__html__dom_8php.html#a008676ca7c003de95f7e6ea6ff92a63b">HDOM_INFO_OUTER</a>])) <span class="keywordflow">return</span> $this-&gt;_[<a class="code" href="simple__html__dom_8php.html#a008676ca7c003de95f7e6ea6ff92a63b">HDOM_INFO_OUTER</a>];
<a name="l00327"></a>00327         <span class="keywordflow">if</span> (isset($this-&gt;_[<a class="code" href="simple__html__dom_8php.html#a9750656802ea115d7b3797e22cf2f07e">HDOM_INFO_TEXT</a>])) <span class="keywordflow">return</span> $this-&gt;dom-&gt;restore_noise($this-&gt;_[HDOM_INFO_TEXT]);
<a name="l00328"></a>00328 
<a name="l00329"></a>00329         <span class="comment">// render begin tag</span>
<a name="l00330"></a>00330         <span class="keywordflow">if</span> ($this-&gt;dom &amp;&amp; $this-&gt;dom-&gt;nodes[$this-&gt;_[<a class="code" href="simple__html__dom_8php.html#a18bc2baf215f9fa2889795e860e30a8f">HDOM_INFO_BEGIN</a>]])
<a name="l00331"></a>00331         {
<a name="l00332"></a>00332             $ret = $this-&gt;dom-&gt;nodes[$this-&gt;_[<a class="code" href="simple__html__dom_8php.html#a18bc2baf215f9fa2889795e860e30a8f">HDOM_INFO_BEGIN</a>]]-&gt;makeup();
<a name="l00333"></a>00333         } <span class="keywordflow">else</span> {
<a name="l00334"></a>00334             $ret = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00335"></a>00335         }
<a name="l00336"></a>00336 
<a name="l00337"></a>00337         <span class="comment">// render inner text</span>
<a name="l00338"></a>00338         <span class="keywordflow">if</span> (isset($this-&gt;_[<a class="code" href="simple__html__dom_8php.html#aabbc85c183b84f80d434add6347dd7fd">HDOM_INFO_INNER</a>]))
<a name="l00339"></a>00339         {
<a name="l00340"></a>00340             <span class="comment">// If it&#39;s a br tag...  don&#39;t return the HDOM_INNER_INFO that we may or may not have added.</span>
<a name="l00341"></a>00341             <span class="keywordflow">if</span> ($this-&gt;tag != <span class="stringliteral">&quot;br&quot;</span>)
<a name="l00342"></a>00342             {
<a name="l00343"></a>00343                 $ret .= $this-&gt;_[<a class="code" href="simple__html__dom_8php.html#aabbc85c183b84f80d434add6347dd7fd">HDOM_INFO_INNER</a>];
<a name="l00344"></a>00344             }
<a name="l00345"></a>00345         } <span class="keywordflow">else</span> {
<a name="l00346"></a>00346             <span class="keywordflow">if</span> ($this-&gt;nodes)
<a name="l00347"></a>00347             {
<a name="l00348"></a>00348                 <span class="keywordflow">foreach</span> ($this-&gt;nodes as $n)
<a name="l00349"></a>00349                 {
<a name="l00350"></a>00350                     $ret .= $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a23887642cd0616d2eed24d7c39c821fc">convert_text</a>($n-&gt;outertext());
<a name="l00351"></a>00351                 }
<a name="l00352"></a>00352             }
<a name="l00353"></a>00353         }
<a name="l00354"></a>00354 
<a name="l00355"></a>00355         <span class="comment">// render end tag</span>
<a name="l00356"></a>00356         <span class="keywordflow">if</span> (isset($this-&gt;_[<a class="code" href="simple__html__dom_8php.html#a13c34186f5e8fa871944f1d39f893ca4">HDOM_INFO_END</a>]) &amp;&amp; $this-&gt;_[<a class="code" href="simple__html__dom_8php.html#a13c34186f5e8fa871944f1d39f893ca4">HDOM_INFO_END</a>]!=0)
<a name="l00357"></a>00357             $ret .= <span class="stringliteral">&#39;&lt;/&#39;</span>.$this-&gt;tag.<span class="charliteral">&#39;&gt;&#39;</span>;
<a name="l00358"></a>00358         <span class="keywordflow">return</span> $ret;
<a name="l00359"></a>00359     }
<a name="l00360"></a>00360 
<a name="l00361"></a>00361     <span class="comment">// get dom node&#39;s plain text</span>
<a name="l00362"></a><a class="code" href="classsimple__html__dom__node.html#a37df362c2f77a0045fa8af094f432238">00362</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a37df362c2f77a0045fa8af094f432238">text</a>()
<a name="l00363"></a>00363     {
<a name="l00364"></a>00364         <span class="keywordflow">if</span> (isset($this-&gt;_[<a class="code" href="simple__html__dom_8php.html#aabbc85c183b84f80d434add6347dd7fd">HDOM_INFO_INNER</a>])) <span class="keywordflow">return</span> $this-&gt;_[<a class="code" href="simple__html__dom_8php.html#aabbc85c183b84f80d434add6347dd7fd">HDOM_INFO_INNER</a>];
<a name="l00365"></a>00365         <span class="keywordflow">switch</span> ($this-&gt;nodetype)
<a name="l00366"></a>00366         {
<a name="l00367"></a>00367             <span class="keywordflow">case</span> <a class="code" href="simple__html__dom_8php.html#a5918dbd4526d477e5fe865f333e9538c">HDOM_TYPE_TEXT</a>: <span class="keywordflow">return</span> $this-&gt;dom-&gt;restore_noise($this-&gt;_[<a class="code" href="simple__html__dom_8php.html#a9750656802ea115d7b3797e22cf2f07e">HDOM_INFO_TEXT</a>]);
<a name="l00368"></a>00368             <span class="keywordflow">case</span> <a class="code" href="simple__html__dom_8php.html#a150eac2dfb509c2e71c53f1a1dbde7ab">HDOM_TYPE_COMMENT</a>: <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;
<a name="l00369"></a>00369             <span class="keywordflow">case</span> <a class="code" href="simple__html__dom_8php.html#a9b8b189e64f2ed2f007a3733ac6b92d2">HDOM_TYPE_UNKNOWN</a>: <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;
<a name="l00370"></a>00370         }
<a name="l00371"></a>00371         <span class="keywordflow">if</span> (strcasecmp($this-&gt;tag, <span class="stringliteral">&#39;script&#39;</span>)===0) <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;
<a name="l00372"></a>00372         <span class="keywordflow">if</span> (strcasecmp($this-&gt;tag, <span class="stringliteral">&#39;style&#39;</span>)===0) <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;
<a name="l00373"></a>00373 
<a name="l00374"></a>00374         $ret = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00375"></a>00375         <span class="comment">// In rare cases, (always node type 1 or HDOM_TYPE_ELEMENT - observed for some span tags, and some p tags) $this-&gt;nodes is set to NULL.</span>
<a name="l00376"></a>00376         <span class="comment">// NOTE: This indicates that there is a problem where it&#39;s set to NULL without a clear happening.</span>
<a name="l00377"></a>00377         <span class="comment">// WHY is this happening?</span>
<a name="l00378"></a>00378         <span class="keywordflow">if</span> (!is_null($this-&gt;nodes))
<a name="l00379"></a>00379         {
<a name="l00380"></a>00380             <span class="keywordflow">foreach</span> ($this-&gt;nodes as $n)
<a name="l00381"></a>00381             {
<a name="l00382"></a>00382                 $ret .= $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a23887642cd0616d2eed24d7c39c821fc">convert_text</a>($n-&gt;text());
<a name="l00383"></a>00383             }
<a name="l00384"></a>00384         }
<a name="l00385"></a>00385         <span class="keywordflow">return</span> $ret;
<a name="l00386"></a>00386     }
<a name="l00387"></a>00387 
<a name="l00388"></a><a class="code" href="classsimple__html__dom__node.html#aaca21e3e742f813c78857a91f389fa66">00388</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#aaca21e3e742f813c78857a91f389fa66">xmltext</a>()
<a name="l00389"></a>00389     {
<a name="l00390"></a>00390         $ret = $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a3791d55e93a3af992d58a3db23abab9b">innertext</a>();
<a name="l00391"></a>00391         $ret = str_ireplace(<span class="stringliteral">&#39;&lt;![CDATA[&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $ret);
<a name="l00392"></a>00392         $ret = str_replace(<span class="stringliteral">&#39;]]&gt;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $ret);
<a name="l00393"></a>00393         <span class="keywordflow">return</span> $ret;
<a name="l00394"></a>00394     }
<a name="l00395"></a>00395 
<a name="l00396"></a>00396     <span class="comment">// build node&#39;s text with tag</span>
<a name="l00397"></a><a class="code" href="classsimple__html__dom__node.html#a6023a015b0fefd6a3b2ad737bf7fd133">00397</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a6023a015b0fefd6a3b2ad737bf7fd133">makeup</a>()
<a name="l00398"></a>00398     {
<a name="l00399"></a>00399         <span class="comment">// text, comment, unknown</span>
<a name="l00400"></a>00400         <span class="keywordflow">if</span> (isset($this-&gt;_[<a class="code" href="simple__html__dom_8php.html#a9750656802ea115d7b3797e22cf2f07e">HDOM_INFO_TEXT</a>])) <span class="keywordflow">return</span> $this-&gt;dom-&gt;restore_noise($this-&gt;_[HDOM_INFO_TEXT]);
<a name="l00401"></a>00401 
<a name="l00402"></a>00402         $ret = <span class="charliteral">&#39;&lt;&#39;</span>.$this-&gt;tag;
<a name="l00403"></a>00403         $i = -1;
<a name="l00404"></a>00404 
<a name="l00405"></a>00405         <span class="keywordflow">foreach</span> ($this-&gt;attr as $key=&gt;$val)
<a name="l00406"></a>00406         {
<a name="l00407"></a>00407             ++$i;
<a name="l00408"></a>00408 
<a name="l00409"></a>00409             <span class="comment">// skip removed attribute</span>
<a name="l00410"></a>00410             <span class="keywordflow">if</span> ($val===null || $val===<span class="keyword">false</span>)
<a name="l00411"></a>00411                 <span class="keywordflow">continue</span>;
<a name="l00412"></a>00412 
<a name="l00413"></a>00413             $ret .= $this-&gt;_[<a class="code" href="simple__html__dom_8php.html#a05a5288384d1d6deb25e6b5cb67eba9b">HDOM_INFO_SPACE</a>][$i][0];
<a name="l00414"></a>00414             <span class="comment">//no value attr: nowrap, checked selected...</span>
<a name="l00415"></a>00415             <span class="keywordflow">if</span> ($val===<span class="keyword">true</span>)
<a name="l00416"></a>00416                 $ret .= $key;
<a name="l00417"></a>00417             <span class="keywordflow">else</span> {
<a name="l00418"></a>00418                 <span class="keywordflow">switch</span> ($this-&gt;_[<a class="code" href="simple__html__dom_8php.html#a1b5b6bdcc0c5597e0e9f0f881ff9ab3c">HDOM_INFO_QUOTE</a>][$i])
<a name="l00419"></a>00419                 {
<a name="l00420"></a>00420                     <span class="keywordflow">case</span> <a class="code" href="simple__html__dom_8php.html#a25b2e9df879f0e9e6c19a2b1a0560270">HDOM_QUOTE_DOUBLE</a>: $quote = <span class="charliteral">&#39;&quot;&#39;</span>; <span class="keywordflow">break</span>;
<a name="l00421"></a>00421                     <span class="keywordflow">case</span> <a class="code" href="simple__html__dom_8php.html#a6c2fdccdefefb69968227c6c3ec6611a">HDOM_QUOTE_SINGLE</a>: $quote = <span class="charliteral">&#39;\&#39;&#39;</span>; <span class="keywordflow">break</span>;
<a name="l00422"></a>00422                     <span class="keywordflow">default</span>: $quote = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00423"></a>00423                 }
<a name="l00424"></a>00424                 $ret .= $key.$this-&gt;_[<a class="code" href="simple__html__dom_8php.html#a05a5288384d1d6deb25e6b5cb67eba9b">HDOM_INFO_SPACE</a>][$i][1].<span class="charliteral">&#39;=&#39;</span>.$this-&gt;_[<a class="code" href="simple__html__dom_8php.html#a05a5288384d1d6deb25e6b5cb67eba9b">HDOM_INFO_SPACE</a>][$i][2].$quote.$val.$quote;
<a name="l00425"></a>00425             }
<a name="l00426"></a>00426         }
<a name="l00427"></a>00427         $ret = $this-&gt;dom-&gt;restore_noise($ret);
<a name="l00428"></a>00428         <span class="keywordflow">return</span> $ret . $this-&gt;_[<a class="code" href="simple__html__dom_8php.html#a886a1a55b0a5ea6c66e0eff6fdea87bc">HDOM_INFO_ENDSPACE</a>] . <span class="charliteral">&#39;&gt;&#39;</span>;
<a name="l00429"></a>00429     }
<a name="l00430"></a>00430 
<a name="l00431"></a>00431     <span class="comment">// find elements by css selector</span>
<a name="l00432"></a>00432     <span class="comment">//PaperG - added ability for find to lowercase the value of the selector.</span>
<a name="l00433"></a><a class="code" href="classsimple__html__dom__node.html#afbf375e355aa32c25f7e389a04ddced0">00433</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#afbf375e355aa32c25f7e389a04ddced0">find</a>($selector, $idx=null, $lowercase=<span class="keyword">false</span>)
<a name="l00434"></a>00434     {
<a name="l00435"></a>00435         $selectors = $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a39d57c8087a0b463eeb942a1d8042013">parse_selector</a>($selector);
<a name="l00436"></a>00436         <span class="keywordflow">if</span> (($count=count($selectors))===0) <span class="keywordflow">return</span> array();
<a name="l00437"></a>00437         $found_keys = array();
<a name="l00438"></a>00438 
<a name="l00439"></a>00439         <span class="comment">// find each selector</span>
<a name="l00440"></a>00440         <span class="keywordflow">for</span> ($c=0; $c&lt;$count; ++$c)
<a name="l00441"></a>00441         {
<a name="l00442"></a>00442             <span class="comment">// The change on the below line was documented on the sourceforge code tracker id 2788009</span>
<a name="l00443"></a>00443             <span class="comment">// used to be: if (($levle=count($selectors[0]))===0) return array();</span>
<a name="l00444"></a>00444             <span class="keywordflow">if</span> (($levle=count($selectors[$c]))===0) <span class="keywordflow">return</span> array();
<a name="l00445"></a>00445             <span class="keywordflow">if</span> (!isset($this-&gt;_[<a class="code" href="simple__html__dom_8php.html#a18bc2baf215f9fa2889795e860e30a8f">HDOM_INFO_BEGIN</a>])) <span class="keywordflow">return</span> array();
<a name="l00446"></a>00446 
<a name="l00447"></a>00447             $head = array($this-&gt;_[HDOM_INFO_BEGIN]=&gt;1);
<a name="l00448"></a>00448 
<a name="l00449"></a>00449             <span class="comment">// handle descendant selectors, no recursive!</span>
<a name="l00450"></a>00450             <span class="keywordflow">for</span> (<a class="code" href="extensions_2_x_m_l_data_source_2lib_2app_2index_8php.html#a3fc62fd062300c58c188533cbe23e1e5">$l</a>=0; <a class="code" href="extensions_2_x_m_l_data_source_2lib_2app_2index_8php.html#a3fc62fd062300c58c188533cbe23e1e5">$l</a>&lt;$levle; ++<a class="code" href="extensions_2_x_m_l_data_source_2lib_2app_2index_8php.html#a3fc62fd062300c58c188533cbe23e1e5">$l</a>)
<a name="l00451"></a>00451             {
<a name="l00452"></a>00452                 $ret = array();
<a name="l00453"></a>00453                 <span class="keywordflow">foreach</span> ($head as $k=&gt;$v)
<a name="l00454"></a>00454                 {
<a name="l00455"></a>00455                     $n = ($k===-1) ? $this-&gt;dom-&gt;root : $this-&gt;dom-&gt;nodes[$k];
<a name="l00456"></a>00456                     <span class="comment">//PaperG - Pass this optional parameter on to the seek function.</span>
<a name="l00457"></a>00457                     $n-&gt;seek($selectors[$c][<a class="code" href="extensions_2_x_m_l_data_source_2lib_2app_2index_8php.html#a3fc62fd062300c58c188533cbe23e1e5">$l</a>], $ret, $lowercase);
<a name="l00458"></a>00458                 }
<a name="l00459"></a>00459                 $head = $ret;
<a name="l00460"></a>00460             }
<a name="l00461"></a>00461 
<a name="l00462"></a>00462             <span class="keywordflow">foreach</span> ($head as $k=&gt;$v)
<a name="l00463"></a>00463             {
<a name="l00464"></a>00464                 <span class="keywordflow">if</span> (!isset($found_keys[$k]))
<a name="l00465"></a>00465                     $found_keys[$k] = 1;
<a name="l00466"></a>00466             }
<a name="l00467"></a>00467         }
<a name="l00468"></a>00468 
<a name="l00469"></a>00469         <span class="comment">// sort keys</span>
<a name="l00470"></a>00470         ksort($found_keys);
<a name="l00471"></a>00471 
<a name="l00472"></a>00472         $found = array();
<a name="l00473"></a>00473         <span class="keywordflow">foreach</span> ($found_keys as $k=&gt;$v)
<a name="l00474"></a>00474             $found[] = $this-&gt;dom-&gt;nodes[$k];
<a name="l00475"></a>00475 
<a name="l00476"></a>00476         <span class="comment">// return nth-element or array</span>
<a name="l00477"></a>00477         <span class="keywordflow">if</span> (is_null($idx)) <span class="keywordflow">return</span> $found;
<a name="l00478"></a>00478         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($idx&lt;0) $idx = count($found) + $idx;
<a name="l00479"></a>00479         <span class="keywordflow">return</span> (isset($found[$idx])) ? $found[$idx] : null;
<a name="l00480"></a>00480     }
<a name="l00481"></a>00481 
<a name="l00482"></a>00482     <span class="comment">// seek for given conditions</span>
<a name="l00483"></a>00483     <span class="comment">// PaperG - added parameter to allow for case insensitive testing of the value of a selector.</span>
<a name="l00484"></a><a class="code" href="classsimple__html__dom__node.html#a55c896ff710c8cb226a17ff3d6e0c17a">00484</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a55c896ff710c8cb226a17ff3d6e0c17a">seek</a>($selector, &amp;$ret, $lowercase=<span class="keyword">false</span>)
<a name="l00485"></a>00485     {
<a name="l00486"></a>00486         global $debugObject;
<a name="l00487"></a>00487         <span class="keywordflow">if</span> (is_object($debugObject))
<a name="l00488"></a>00488         {
<a name="l00489"></a>00489             $debugObject-&gt;debugLogEntry(1);
<a name="l00490"></a>00490         }
<a name="l00491"></a>00491 
<a name="l00492"></a>00492         list(<a class="code" href="classsimple__html__dom__node.html#a81d5015d41ed8ec66e9db8cdc5db9555">$tag</a>, $key, $val, $exp, $no_key) = $selector;
<a name="l00493"></a>00493 
<a name="l00494"></a>00494         <span class="comment">// xpath index</span>
<a name="l00495"></a>00495         <span class="keywordflow">if</span> (<a class="code" href="classsimple__html__dom__node.html#a81d5015d41ed8ec66e9db8cdc5db9555">$tag</a> &amp;&amp; $key &amp;&amp; is_numeric($key))
<a name="l00496"></a>00496         {
<a name="l00497"></a>00497             $count = 0;
<a name="l00498"></a>00498             <span class="keywordflow">foreach</span> ($this-&gt;<a class="code" href="classsimple__html__dom__node.html#a42d02529839611cba362c6b5ce58f719">children</a> as $c)
<a name="l00499"></a>00499             {
<a name="l00500"></a>00500                 <span class="keywordflow">if</span> (<a class="code" href="classsimple__html__dom__node.html#a81d5015d41ed8ec66e9db8cdc5db9555">$tag</a>===<span class="charliteral">&#39;*&#39;</span> || <a class="code" href="classsimple__html__dom__node.html#a81d5015d41ed8ec66e9db8cdc5db9555">$tag</a>===$c-&gt;tag) {
<a name="l00501"></a>00501                     <span class="keywordflow">if</span> (++$count==$key) {
<a name="l00502"></a>00502                         $ret[$c-&gt;_[<a class="code" href="simple__html__dom_8php.html#a18bc2baf215f9fa2889795e860e30a8f">HDOM_INFO_BEGIN</a>]] = 1;
<a name="l00503"></a>00503                         <span class="keywordflow">return</span>;
<a name="l00504"></a>00504                     }
<a name="l00505"></a>00505                 }
<a name="l00506"></a>00506             }
<a name="l00507"></a>00507             <span class="keywordflow">return</span>;
<a name="l00508"></a>00508         }
<a name="l00509"></a>00509 
<a name="l00510"></a>00510         $end = (!empty($this-&gt;_[<a class="code" href="simple__html__dom_8php.html#a13c34186f5e8fa871944f1d39f893ca4">HDOM_INFO_END</a>])) ? $this-&gt;_[HDOM_INFO_END] : 0;
<a name="l00511"></a>00511         <span class="keywordflow">if</span> ($end==0) {
<a name="l00512"></a>00512             <a class="code" href="classsimple__html__dom__node.html#a4e2313a4b35b72a06ac45fd38960f677">$parent</a> = $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a3249177749c4f2274ed77044179f7f6b">parent</a>;
<a name="l00513"></a>00513             <span class="keywordflow">while</span> (!isset(<a class="code" href="classsimple__html__dom__node.html#a4e2313a4b35b72a06ac45fd38960f677">$parent</a>-&gt;_[HDOM_INFO_END]) &amp;&amp; <a class="code" href="classsimple__html__dom__node.html#a4e2313a4b35b72a06ac45fd38960f677">$parent</a>!==null) {
<a name="l00514"></a>00514                 $end -= 1;
<a name="l00515"></a>00515                 <a class="code" href="classsimple__html__dom__node.html#a4e2313a4b35b72a06ac45fd38960f677">$parent</a> = <a class="code" href="classsimple__html__dom__node.html#a4e2313a4b35b72a06ac45fd38960f677">$parent</a>-&gt;parent;
<a name="l00516"></a>00516             }
<a name="l00517"></a>00517             $end += <a class="code" href="classsimple__html__dom__node.html#a4e2313a4b35b72a06ac45fd38960f677">$parent</a>-&gt;_[<a class="code" href="simple__html__dom_8php.html#a13c34186f5e8fa871944f1d39f893ca4">HDOM_INFO_END</a>];
<a name="l00518"></a>00518         }
<a name="l00519"></a>00519 
<a name="l00520"></a>00520         <span class="keywordflow">for</span> ($i=$this-&gt;_[<a class="code" href="simple__html__dom_8php.html#a18bc2baf215f9fa2889795e860e30a8f">HDOM_INFO_BEGIN</a>]+1; $i&lt;$end; ++$i) {
<a name="l00521"></a>00521             $node = $this-&gt;dom-&gt;nodes[$i];
<a name="l00522"></a>00522 
<a name="l00523"></a>00523             $pass = <span class="keyword">true</span>;
<a name="l00524"></a>00524 
<a name="l00525"></a>00525             <span class="keywordflow">if</span> (<a class="code" href="classsimple__html__dom__node.html#a81d5015d41ed8ec66e9db8cdc5db9555">$tag</a>===<span class="charliteral">&#39;*&#39;</span> &amp;&amp; !$key) {
<a name="l00526"></a>00526                 <span class="keywordflow">if</span> (in_array($node, $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a42d02529839611cba362c6b5ce58f719">children</a>, <span class="keyword">true</span>))
<a name="l00527"></a>00527                     $ret[$i] = 1;
<a name="l00528"></a>00528                 <span class="keywordflow">continue</span>;
<a name="l00529"></a>00529             }
<a name="l00530"></a>00530 
<a name="l00531"></a>00531             <span class="comment">// compare tag</span>
<a name="l00532"></a>00532             <span class="keywordflow">if</span> (<a class="code" href="classsimple__html__dom__node.html#a81d5015d41ed8ec66e9db8cdc5db9555">$tag</a> &amp;&amp; <a class="code" href="classsimple__html__dom__node.html#a81d5015d41ed8ec66e9db8cdc5db9555">$tag</a>!=$node-&gt;tag &amp;&amp; <a class="code" href="classsimple__html__dom__node.html#a81d5015d41ed8ec66e9db8cdc5db9555">$tag</a>!==<span class="charliteral">&#39;*&#39;</span>) {$pass=<span class="keyword">false</span>;}
<a name="l00533"></a>00533             <span class="comment">// compare key</span>
<a name="l00534"></a>00534             <span class="keywordflow">if</span> ($pass &amp;&amp; $key) {
<a name="l00535"></a>00535                 <span class="keywordflow">if</span> ($no_key) {
<a name="l00536"></a>00536                     <span class="keywordflow">if</span> (isset($node-&gt;attr[$key])) $pass=<span class="keyword">false</span>;
<a name="l00537"></a>00537                 } <span class="keywordflow">else</span> {
<a name="l00538"></a>00538                     <span class="keywordflow">if</span> (($key != <span class="stringliteral">&quot;plaintext&quot;</span>) &amp;&amp; !isset($node-&gt;attr[$key])) $pass=<span class="keyword">false</span>;
<a name="l00539"></a>00539                 }
<a name="l00540"></a>00540             }
<a name="l00541"></a>00541             <span class="comment">// compare value</span>
<a name="l00542"></a>00542             <span class="keywordflow">if</span> ($pass &amp;&amp; $key &amp;&amp; $val  &amp;&amp; $val!==<span class="charliteral">&#39;*&#39;</span>) {
<a name="l00543"></a>00543                 <span class="comment">// If they have told us that this is a &quot;plaintext&quot; search then we want the plaintext of the node - right?</span>
<a name="l00544"></a>00544                 <span class="keywordflow">if</span> ($key == <span class="stringliteral">&quot;plaintext&quot;</span>) {
<a name="l00545"></a>00545                     <span class="comment">// $node-&gt;plaintext actually returns $node-&gt;text();</span>
<a name="l00546"></a>00546                     $nodeKeyValue = $node-&gt;text();
<a name="l00547"></a>00547                 } <span class="keywordflow">else</span> {
<a name="l00548"></a>00548                     <span class="comment">// this is a normal search, we want the value of that attribute of the tag.</span>
<a name="l00549"></a>00549                     $nodeKeyValue = $node-&gt;attr[$key];
<a name="l00550"></a>00550                 }
<a name="l00551"></a>00551                 <span class="keywordflow">if</span> (is_object($debugObject)) {$debugObject-&gt;debugLog(2, <span class="stringliteral">&quot;testing node: &quot;</span> . $node-&gt;tag . <span class="stringliteral">&quot; for attribute: &quot;</span> . $key . $exp . $val . <span class="stringliteral">&quot; where nodes value is: &quot;</span> . $nodeKeyValue);}
<a name="l00552"></a>00552 
<a name="l00553"></a>00553                 <span class="comment">//PaperG - If lowercase is set, do a case insensitive test of the value of the selector.</span>
<a name="l00554"></a>00554                 <span class="keywordflow">if</span> ($lowercase) {
<a name="l00555"></a>00555                     $check = $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a9c8fedd7bb7953c0849835ace1d11852">match</a>($exp, strtolower($val), strtolower($nodeKeyValue));
<a name="l00556"></a>00556                 } <span class="keywordflow">else</span> {
<a name="l00557"></a>00557                     $check = $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a9c8fedd7bb7953c0849835ace1d11852">match</a>($exp, $val, $nodeKeyValue);
<a name="l00558"></a>00558                 }
<a name="l00559"></a>00559                 <span class="keywordflow">if</span> (is_object($debugObject)) {$debugObject-&gt;debugLog(2, <span class="stringliteral">&quot;after match: &quot;</span> . ($check ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>));}
<a name="l00560"></a>00560 
<a name="l00561"></a>00561                 <span class="comment">// handle multiple class</span>
<a name="l00562"></a>00562                 <span class="keywordflow">if</span> (!$check &amp;&amp; strcasecmp($key, <span class="stringliteral">&#39;class&#39;</span>)===0) {
<a name="l00563"></a>00563                     <span class="keywordflow">foreach</span> (explode(<span class="charliteral">&#39; &#39;</span>,$node-&gt;attr[$key]) as $k) {
<a name="l00564"></a>00564                         <span class="comment">// Without this, there were cases where leading, trailing, or double spaces lead to our comparing blanks - bad form.</span>
<a name="l00565"></a>00565                         <span class="keywordflow">if</span> (!empty($k)) {
<a name="l00566"></a>00566                             <span class="keywordflow">if</span> ($lowercase) {
<a name="l00567"></a>00567                                 $check = $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a9c8fedd7bb7953c0849835ace1d11852">match</a>($exp, strtolower($val), strtolower($k));
<a name="l00568"></a>00568                             } <span class="keywordflow">else</span> {
<a name="l00569"></a>00569                                 $check = $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a9c8fedd7bb7953c0849835ace1d11852">match</a>($exp, $val, $k);
<a name="l00570"></a>00570                             }
<a name="l00571"></a>00571                             <span class="keywordflow">if</span> ($check) <span class="keywordflow">break</span>;
<a name="l00572"></a>00572                         }
<a name="l00573"></a>00573                     }
<a name="l00574"></a>00574                 }
<a name="l00575"></a>00575                 <span class="keywordflow">if</span> (!$check) $pass = <span class="keyword">false</span>;
<a name="l00576"></a>00576             }
<a name="l00577"></a>00577             <span class="keywordflow">if</span> ($pass) $ret[$i] = 1;
<a name="l00578"></a>00578             unset($node);
<a name="l00579"></a>00579         }
<a name="l00580"></a>00580         <span class="comment">// It&#39;s passed by reference so this is actually what this function returns.</span>
<a name="l00581"></a>00581         <span class="keywordflow">if</span> (is_object($debugObject)) {$debugObject-&gt;debugLog(1, <span class="stringliteral">&quot;EXIT - ret: &quot;</span>, $ret);}
<a name="l00582"></a>00582     }
<a name="l00583"></a>00583 
<a name="l00584"></a><a class="code" href="classsimple__html__dom__node.html#a9c8fedd7bb7953c0849835ace1d11852">00584</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a9c8fedd7bb7953c0849835ace1d11852">match</a>($exp, $pattern, $value) {
<a name="l00585"></a>00585         global $debugObject;
<a name="l00586"></a>00586         <span class="keywordflow">if</span> (is_object($debugObject)) {$debugObject-&gt;debugLogEntry(1);}
<a name="l00587"></a>00587 
<a name="l00588"></a>00588         <span class="keywordflow">switch</span> ($exp) {
<a name="l00589"></a>00589             <span class="keywordflow">case</span> <span class="charliteral">&#39;=&#39;</span>:
<a name="l00590"></a>00590                 <span class="keywordflow">return</span> ($value===$pattern);
<a name="l00591"></a>00591             <span class="keywordflow">case</span> <span class="stringliteral">&#39;!=&#39;</span>:
<a name="l00592"></a>00592                 <span class="keywordflow">return</span> ($value!==$pattern);
<a name="l00593"></a>00593             <span class="keywordflow">case</span> <span class="stringliteral">&#39;^=&#39;</span>:
<a name="l00594"></a>00594                 <span class="keywordflow">return</span> preg_match(<span class="stringliteral">&quot;/^&quot;</span>.preg_quote($pattern,<span class="charliteral">&#39;/&#39;</span>).<span class="stringliteral">&quot;/&quot;</span>, $value);
<a name="l00595"></a>00595             <span class="keywordflow">case</span> <span class="stringliteral">&#39;$=&#39;</span>:
<a name="l00596"></a>00596                 <span class="keywordflow">return</span> preg_match(<span class="stringliteral">&quot;/&quot;</span>.preg_quote($pattern,<span class="charliteral">&#39;/&#39;</span>).<span class="stringliteral">&quot;$/&quot;</span>, $value);
<a name="l00597"></a>00597             <span class="keywordflow">case</span> <span class="stringliteral">&#39;*=&#39;</span>:
<a name="l00598"></a>00598                 <span class="keywordflow">if</span> ($pattern[0]==<span class="charliteral">&#39;/&#39;</span>) {
<a name="l00599"></a>00599                     <span class="keywordflow">return</span> preg_match($pattern, $value);
<a name="l00600"></a>00600                 }
<a name="l00601"></a>00601                 <span class="keywordflow">return</span> preg_match(<span class="stringliteral">&quot;/&quot;</span>.$pattern.<span class="stringliteral">&quot;/i&quot;</span>, $value);
<a name="l00602"></a>00602         }
<a name="l00603"></a>00603         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00604"></a>00604     }
<a name="l00605"></a>00605 
<a name="l00606"></a><a class="code" href="classsimple__html__dom__node.html#a39d57c8087a0b463eeb942a1d8042013">00606</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a39d57c8087a0b463eeb942a1d8042013">parse_selector</a>($selector_string) {
<a name="l00607"></a>00607         global $debugObject;
<a name="l00608"></a>00608         <span class="keywordflow">if</span> (is_object($debugObject)) {$debugObject-&gt;debugLogEntry(1);}
<a name="l00609"></a>00609 
<a name="l00610"></a>00610         <span class="comment">// pattern of CSS selectors, modified from mootools</span>
<a name="l00611"></a>00611         <span class="comment">// Paperg: Add the colon to the attrbute, so that it properly finds &lt;tag attr:ibute=&quot;something&quot; &gt; like google does.</span>
<a name="l00612"></a>00612         <span class="comment">// Note: if you try to look at this attribute, yo MUST use getAttribute since $dom-&gt;x:y will fail the php syntax check.</span>
<a name="l00613"></a>00613 <span class="comment">// Notice the \[ starting the attbute?  and the @? following?  This implies that an attribute can begin with an @ sign that is not captured.</span>
<a name="l00614"></a>00614 <span class="comment">// This implies that an html attribute specifier may start with an @ sign that is NOT captured by the expression.</span>
<a name="l00615"></a>00615 <span class="comment">// farther study is required to determine of this should be documented or removed.</span>
<a name="l00616"></a>00616 <span class="comment">//        $pattern = &quot;/([\w-:\*]*)(?:\#([\w-]+)|\.([\w-]+))?(?:\[@?(!?[\w-]+)(?:([!*^$]?=)[\&quot;&#39;]?(.*?)[\&quot;&#39;]?)?\])?([\/, ]+)/is&quot;;</span>
<a name="l00617"></a>00617         $pattern = <span class="stringliteral">&quot;/([\w-:\*]*)(?:\#([\w-]+)|\.([\w-]+))?(?:\[@?(!?[\w-:]+)(?:([!*^$]?=)[\&quot;&#39;]?(.*?)[\&quot;&#39;]?)?\])?([\/, ]+)/is&quot;</span>;
<a name="l00618"></a>00618         preg_match_all($pattern, trim($selector_string).<span class="charliteral">&#39; &#39;</span>, $matches, PREG_SET_ORDER);
<a name="l00619"></a>00619         <span class="keywordflow">if</span> (is_object($debugObject)) {$debugObject-&gt;debugLog(2, <span class="stringliteral">&quot;Matches Array: &quot;</span>, $matches);}
<a name="l00620"></a>00620 
<a name="l00621"></a>00621         $selectors = array();
<a name="l00622"></a>00622         $result = array();
<a name="l00623"></a>00623         <span class="comment">//print_r($matches);</span>
<a name="l00624"></a>00624 
<a name="l00625"></a>00625         <span class="keywordflow">foreach</span> ($matches as $m) {
<a name="l00626"></a>00626             $m[0] = trim($m[0]);
<a name="l00627"></a>00627             <span class="keywordflow">if</span> ($m[0]===<span class="stringliteral">&#39;&#39;</span> || $m[0]===<span class="charliteral">&#39;/&#39;</span> || $m[0]===<span class="stringliteral">&#39;//&#39;</span>) <span class="keywordflow">continue</span>;
<a name="l00628"></a>00628             <span class="comment">// for browser generated xpath</span>
<a name="l00629"></a>00629             <span class="keywordflow">if</span> ($m[1]===<span class="stringliteral">&#39;tbody&#39;</span>) <span class="keywordflow">continue</span>;
<a name="l00630"></a>00630 
<a name="l00631"></a>00631             list(<a class="code" href="classsimple__html__dom__node.html#a81d5015d41ed8ec66e9db8cdc5db9555">$tag</a>, $key, $val, $exp, $no_key) = array($m[1], null, null, <span class="charliteral">&#39;=&#39;</span>, <span class="keyword">false</span>);
<a name="l00632"></a>00632             <span class="keywordflow">if</span> (!empty($m[2])) {$key=<span class="stringliteral">&#39;id&#39;</span>; $val=$m[2];}
<a name="l00633"></a>00633             <span class="keywordflow">if</span> (!empty($m[3])) {$key=<span class="stringliteral">&#39;class&#39;</span>; $val=$m[3];}
<a name="l00634"></a>00634             <span class="keywordflow">if</span> (!empty($m[4])) {$key=$m[4];}
<a name="l00635"></a>00635             <span class="keywordflow">if</span> (!empty($m[5])) {$exp=$m[5];}
<a name="l00636"></a>00636             <span class="keywordflow">if</span> (!empty($m[6])) {$val=$m[6];}
<a name="l00637"></a>00637 
<a name="l00638"></a>00638             <span class="comment">// convert to lowercase</span>
<a name="l00639"></a>00639             <span class="keywordflow">if</span> ($this-&gt;dom-&gt;lowercase) {<a class="code" href="classsimple__html__dom__node.html#a81d5015d41ed8ec66e9db8cdc5db9555">$tag</a>=strtolower(<a class="code" href="classsimple__html__dom__node.html#a81d5015d41ed8ec66e9db8cdc5db9555">$tag</a>); $key=strtolower($key);}
<a name="l00640"></a>00640             <span class="comment">//elements that do NOT have the specified attribute</span>
<a name="l00641"></a>00641             <span class="keywordflow">if</span> (isset($key[0]) &amp;&amp; $key[0]===<span class="charliteral">&#39;!&#39;</span>) {$key=substr($key, 1); $no_key=<span class="keyword">true</span>;}
<a name="l00642"></a>00642 
<a name="l00643"></a>00643             $result[] = array(<a class="code" href="classsimple__html__dom__node.html#a81d5015d41ed8ec66e9db8cdc5db9555">$tag</a>, $key, $val, $exp, $no_key);
<a name="l00644"></a>00644             <span class="keywordflow">if</span> (trim($m[7])===<span class="charliteral">&#39;,&#39;</span>) {
<a name="l00645"></a>00645                 $selectors[] = $result;
<a name="l00646"></a>00646                 $result = array();
<a name="l00647"></a>00647             }
<a name="l00648"></a>00648         }
<a name="l00649"></a>00649         <span class="keywordflow">if</span> (count($result)&gt;0)
<a name="l00650"></a>00650             $selectors[] = $result;
<a name="l00651"></a>00651         <span class="keywordflow">return</span> $selectors;
<a name="l00652"></a>00652     }
<a name="l00653"></a>00653 
<a name="l00654"></a><a class="code" href="classsimple__html__dom__node.html#abc8e9e31bb15c8a44c3210ec551407c8">00654</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#abc8e9e31bb15c8a44c3210ec551407c8">__get</a>($name) {
<a name="l00655"></a>00655         <span class="keywordflow">if</span> (isset($this-&gt;attr[$name]))
<a name="l00656"></a>00656         {
<a name="l00657"></a>00657             <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a23887642cd0616d2eed24d7c39c821fc">convert_text</a>($this-&gt;attr[$name]);
<a name="l00658"></a>00658         }
<a name="l00659"></a>00659         <span class="keywordflow">switch</span> ($name) {
<a name="l00660"></a>00660             <span class="keywordflow">case</span> <span class="stringliteral">&#39;outertext&#39;</span>: <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a64d25961093a3b4c7b9b26a6d56c5831">outertext</a>();
<a name="l00661"></a>00661             <span class="keywordflow">case</span> <span class="stringliteral">&#39;innertext&#39;</span>: <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a3791d55e93a3af992d58a3db23abab9b">innertext</a>();
<a name="l00662"></a>00662             <span class="keywordflow">case</span> <span class="stringliteral">&#39;plaintext&#39;</span>: <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a37df362c2f77a0045fa8af094f432238">text</a>();
<a name="l00663"></a>00663             <span class="keywordflow">case</span> <span class="stringliteral">&#39;xmltext&#39;</span>: <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#aaca21e3e742f813c78857a91f389fa66">xmltext</a>();
<a name="l00664"></a>00664             <span class="keywordflow">default</span>: <span class="keywordflow">return</span> array_key_exists($name, $this-&gt;attr);
<a name="l00665"></a>00665         }
<a name="l00666"></a>00666     }
<a name="l00667"></a>00667 
<a name="l00668"></a><a class="code" href="classsimple__html__dom__node.html#a83c2703c91959192f759992ad5640b67">00668</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a83c2703c91959192f759992ad5640b67">__set</a>($name, $value) {
<a name="l00669"></a>00669         <span class="keywordflow">switch</span> ($name) {
<a name="l00670"></a>00670             <span class="keywordflow">case</span> <span class="stringliteral">&#39;outertext&#39;</span>: <span class="keywordflow">return</span> $this-&gt;_[<a class="code" href="simple__html__dom_8php.html#a008676ca7c003de95f7e6ea6ff92a63b">HDOM_INFO_OUTER</a>] = $value;
<a name="l00671"></a>00671             <span class="keywordflow">case</span> <span class="stringliteral">&#39;innertext&#39;</span>:
<a name="l00672"></a>00672                 <span class="keywordflow">if</span> (isset($this-&gt;_[<a class="code" href="simple__html__dom_8php.html#a9750656802ea115d7b3797e22cf2f07e">HDOM_INFO_TEXT</a>])) <span class="keywordflow">return</span> $this-&gt;_[<a class="code" href="simple__html__dom_8php.html#a9750656802ea115d7b3797e22cf2f07e">HDOM_INFO_TEXT</a>] = $value;
<a name="l00673"></a>00673                 <span class="keywordflow">return</span> $this-&gt;_[<a class="code" href="simple__html__dom_8php.html#aabbc85c183b84f80d434add6347dd7fd">HDOM_INFO_INNER</a>] = $value;
<a name="l00674"></a>00674         }
<a name="l00675"></a>00675         <span class="keywordflow">if</span> (!isset($this-&gt;attr[$name])) {
<a name="l00676"></a>00676             $this-&gt;_[<a class="code" href="simple__html__dom_8php.html#a05a5288384d1d6deb25e6b5cb67eba9b">HDOM_INFO_SPACE</a>][] = array(<span class="charliteral">&#39; &#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>);
<a name="l00677"></a>00677             $this-&gt;_[<a class="code" href="simple__html__dom_8php.html#a1b5b6bdcc0c5597e0e9f0f881ff9ab3c">HDOM_INFO_QUOTE</a>][] = <a class="code" href="simple__html__dom_8php.html#a25b2e9df879f0e9e6c19a2b1a0560270">HDOM_QUOTE_DOUBLE</a>;
<a name="l00678"></a>00678         }
<a name="l00679"></a>00679         $this-&gt;attr[$name] = $value;
<a name="l00680"></a>00680     }
<a name="l00681"></a>00681 
<a name="l00682"></a><a class="code" href="classsimple__html__dom__node.html#a8f132f051b7cd7d570ccb9f6e2bb4201">00682</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a8f132f051b7cd7d570ccb9f6e2bb4201">__isset</a>($name) {
<a name="l00683"></a>00683         <span class="keywordflow">switch</span> ($name) {
<a name="l00684"></a>00684             <span class="keywordflow">case</span> <span class="stringliteral">&#39;outertext&#39;</span>: <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00685"></a>00685             <span class="keywordflow">case</span> <span class="stringliteral">&#39;innertext&#39;</span>: <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00686"></a>00686             <span class="keywordflow">case</span> <span class="stringliteral">&#39;plaintext&#39;</span>: <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00687"></a>00687         }
<a name="l00688"></a>00688         <span class="comment">//no value attr: nowrap, checked selected...</span>
<a name="l00689"></a>00689         <span class="keywordflow">return</span> (array_key_exists($name, $this-&gt;attr)) ? <span class="keyword">true</span> : isset($this-&gt;attr[$name]);
<a name="l00690"></a>00690     }
<a name="l00691"></a>00691 
<a name="l00692"></a><a class="code" href="classsimple__html__dom__node.html#a8a93654c7bfe3f0a9bb7af531e513d44">00692</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a8a93654c7bfe3f0a9bb7af531e513d44">__unset</a>($name) {
<a name="l00693"></a>00693         <span class="keywordflow">if</span> (isset($this-&gt;attr[$name]))
<a name="l00694"></a>00694             unset($this-&gt;attr[$name]);
<a name="l00695"></a>00695     }
<a name="l00696"></a>00696 
<a name="l00697"></a>00697     <span class="comment">// PaperG - Function to convert the text from one character set to another if the two sets are not the same.</span>
<a name="l00698"></a><a class="code" href="classsimple__html__dom__node.html#a23887642cd0616d2eed24d7c39c821fc">00698</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a23887642cd0616d2eed24d7c39c821fc">convert_text</a>($text) {
<a name="l00699"></a>00699         global $debugObject;
<a name="l00700"></a>00700         <span class="keywordflow">if</span> (is_object($debugObject)) {$debugObject-&gt;debugLogEntry(1);}
<a name="l00701"></a>00701 
<a name="l00702"></a>00702         $converted_text = $text;
<a name="l00703"></a>00703 
<a name="l00704"></a>00704         $sourceCharset = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00705"></a>00705         $targetCharset = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00706"></a>00706         <span class="keywordflow">if</span> ($this-&gt;dom) {
<a name="l00707"></a>00707             $sourceCharset = strtoupper($this-&gt;dom-&gt;_charset);
<a name="l00708"></a>00708             $targetCharset = strtoupper($this-&gt;dom-&gt;_target_charset);
<a name="l00709"></a>00709         }
<a name="l00710"></a>00710         <span class="keywordflow">if</span> (is_object($debugObject)) {$debugObject-&gt;debugLog(3, <span class="stringliteral">&quot;source charset: &quot;</span> . $sourceCharset . <span class="stringliteral">&quot; target charaset: &quot;</span> . $targetCharset);}
<a name="l00711"></a>00711 
<a name="l00712"></a>00712         <span class="keywordflow">if</span> (!empty($sourceCharset) &amp;&amp; !empty($targetCharset) &amp;&amp; (strcasecmp($sourceCharset, $targetCharset) != 0))
<a name="l00713"></a>00713         {
<a name="l00714"></a>00714             <span class="comment">// Check if the reported encoding could have been incorrect and the text is actually already UTF-8</span>
<a name="l00715"></a>00715             <span class="keywordflow">if</span> ((strcasecmp($targetCharset, <span class="stringliteral">&#39;UTF-8&#39;</span>) == 0) &amp;&amp; ($this-&gt;<a class="code" href="classsimple__html__dom__node.html#aac22216953f6f0ea1d78321d261ebad8">is_utf8</a>($text)))
<a name="l00716"></a>00716             {
<a name="l00717"></a>00717                 $converted_text = $text;
<a name="l00718"></a>00718             }
<a name="l00719"></a>00719             <span class="keywordflow">else</span>
<a name="l00720"></a>00720             {
<a name="l00721"></a>00721                 $converted_text = iconv($sourceCharset, $targetCharset, $text);
<a name="l00722"></a>00722             }
<a name="l00723"></a>00723         }
<a name="l00724"></a>00724 
<a name="l00725"></a>00725         <span class="keywordflow">return</span> $converted_text;
<a name="l00726"></a>00726     }
<a name="l00727"></a>00727 
<a name="l00728"></a><a class="code" href="classsimple__html__dom__node.html#aac22216953f6f0ea1d78321d261ebad8">00728</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#aac22216953f6f0ea1d78321d261ebad8">is_utf8</a>($string)
<a name="l00729"></a>00729     {
<a name="l00730"></a>00730         <span class="keywordflow">return</span> (utf8_encode(utf8_decode($string)) == $string);
<a name="l00731"></a>00731     }
<a name="l00732"></a>00732 
<a name="l00733"></a>00733     <span class="comment">// camel naming conventions</span>
<a name="l00734"></a><a class="code" href="classsimple__html__dom__node.html#a87ba362b0d72b64e0da6f095c5c40ba5">00734</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a87ba362b0d72b64e0da6f095c5c40ba5">getAllAttributes</a>() {<span class="keywordflow">return</span> $this-&gt;attr;}
<a name="l00735"></a><a class="code" href="classsimple__html__dom__node.html#ae954da422d40fc286691e54679e44c6f">00735</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#ae954da422d40fc286691e54679e44c6f">getAttribute</a>($name) {<span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#abc8e9e31bb15c8a44c3210ec551407c8">__get</a>($name);}
<a name="l00736"></a><a class="code" href="classsimple__html__dom__node.html#a545f43e4d937e0e272a4bafe8b411d55">00736</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a545f43e4d937e0e272a4bafe8b411d55">setAttribute</a>($name, $value) {$this-&gt;<a class="code" href="classsimple__html__dom__node.html#a83c2703c91959192f759992ad5640b67">__set</a>($name, $value);}
<a name="l00737"></a><a class="code" href="classsimple__html__dom__node.html#ac78ba27a41d0291c61326022489d4986">00737</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#ac78ba27a41d0291c61326022489d4986">hasAttribute</a>($name) {<span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a8f132f051b7cd7d570ccb9f6e2bb4201">__isset</a>($name);}
<a name="l00738"></a><a class="code" href="classsimple__html__dom__node.html#abbf04707cf678979459a4438e1450876">00738</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#abbf04707cf678979459a4438e1450876">removeAttribute</a>($name) {$this-&gt;<a class="code" href="classsimple__html__dom__node.html#a83c2703c91959192f759992ad5640b67">__set</a>($name, null);}
<a name="l00739"></a><a class="code" href="classsimple__html__dom__node.html#aec6ca41b9859728595ece521ca638e48">00739</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#aec6ca41b9859728595ece521ca638e48">getElementById</a>($id) {<span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#afbf375e355aa32c25f7e389a04ddced0">find</a>(<span class="stringliteral">&quot;#$id&quot;</span>, 0);}
<a name="l00740"></a><a class="code" href="classsimple__html__dom__node.html#a12433180a44804217a6089284c1e337a">00740</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a12433180a44804217a6089284c1e337a">getElementsById</a>($id, $idx=null) {<span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#afbf375e355aa32c25f7e389a04ddced0">find</a>(<span class="stringliteral">&quot;#$id&quot;</span>, $idx);}
<a name="l00741"></a><a class="code" href="classsimple__html__dom__node.html#a73eb6caf89c86044a5ed0092484f375d">00741</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a73eb6caf89c86044a5ed0092484f375d">getElementByTagName</a>($name) {<span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#afbf375e355aa32c25f7e389a04ddced0">find</a>($name, 0);}
<a name="l00742"></a><a class="code" href="classsimple__html__dom__node.html#a7d6c89e0ea53cd3866bb03eac8ef300d">00742</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a7d6c89e0ea53cd3866bb03eac8ef300d">getElementsByTagName</a>($name, $idx=null) {<span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#afbf375e355aa32c25f7e389a04ddced0">find</a>($name, $idx);}
<a name="l00743"></a><a class="code" href="classsimple__html__dom__node.html#a38cacd4491f3f41cf275df362bb64c06">00743</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a38cacd4491f3f41cf275df362bb64c06">parentNode</a>() {<span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a3249177749c4f2274ed77044179f7f6b">parent</a>();}
<a name="l00744"></a><a class="code" href="classsimple__html__dom__node.html#a543b9f022b4d71d19a8f055b3b87bb77">00744</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a543b9f022b4d71d19a8f055b3b87bb77">childNodes</a>($idx=-1) {<span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a42d02529839611cba362c6b5ce58f719">children</a>($idx);}
<a name="l00745"></a><a class="code" href="classsimple__html__dom__node.html#a2e7ff3e4db465652634f86004ccb83db">00745</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a2e7ff3e4db465652634f86004ccb83db">firstChild</a>() {<span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#ade851eb21476ec16857ed56d166f6afc">first_child</a>();}
<a name="l00746"></a><a class="code" href="classsimple__html__dom__node.html#aa290d153aa9b41988d2b4bfb23424241">00746</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#aa290d153aa9b41988d2b4bfb23424241">lastChild</a>() {<span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#a97160a76243a59b48b26e6d96b07b6ea">last_child</a>();}
<a name="l00747"></a><a class="code" href="classsimple__html__dom__node.html#a6ef403032300227cea0cbd91e4ddccba">00747</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#a6ef403032300227cea0cbd91e4ddccba">nextSibling</a>() {<span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#ade0fb39187948a5a6772dfc30252f8f8">next_sibling</a>();}
<a name="l00748"></a><a class="code" href="classsimple__html__dom__node.html#abd98231235f474bb5a4457715cdbd333">00748</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom__node.html#abd98231235f474bb5a4457715cdbd333">previousSibling</a>() {<span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom__node.html#acea92e7c0be16e44d15cc502cec229d8">prev_sibling</a>();}
<a name="l00749"></a>00749 }
<a name="l00750"></a>00750 
<a name="l00759"></a><a class="code" href="classsimple__html__dom.html">00759</a> <span class="keyword">class </span><a class="code" href="classsimple__html__dom.html">simple_html_dom</a> {
<a name="l00760"></a><a class="code" href="classsimple__html__dom.html#ab37f7c32f41c3c61ed940887453767f4">00760</a>     <span class="keyword">public</span> <a class="code" href="classsimple__html__dom.html#ab37f7c32f41c3c61ed940887453767f4">$root</a> = null;
<a name="l00761"></a><a class="code" href="classsimple__html__dom.html#afc84f46342a660cca8589570197bc421">00761</a>     <span class="keyword">public</span> <a class="code" href="classsimple__html__dom.html#afc84f46342a660cca8589570197bc421">$nodes</a> = array();
<a name="l00762"></a><a class="code" href="classsimple__html__dom.html#abc7c2ac0d93d22f71221e8b60512c860">00762</a>     <span class="keyword">public</span> <a class="code" href="classsimple__html__dom.html#abc7c2ac0d93d22f71221e8b60512c860">$callback</a> = null;
<a name="l00763"></a><a class="code" href="classsimple__html__dom.html#a8e20508789d34bc35e3b00ad58159d1c">00763</a>     <span class="keyword">public</span> <a class="code" href="classsimple__html__dom.html#a8e20508789d34bc35e3b00ad58159d1c">$lowercase</a> = <span class="keyword">false</span>;
<a name="l00764"></a><a class="code" href="classsimple__html__dom.html#af594986e4618a8d6a5d7566617f583c6">00764</a>     <span class="keyword">public</span> <a class="code" href="classsimple__html__dom.html#af594986e4618a8d6a5d7566617f583c6">$size</a>;
<a name="l00765"></a><a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">00765</a>     <span class="keyword">protected</span> <a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>;
<a name="l00766"></a><a class="code" href="classsimple__html__dom.html#afc5e9ce512cd97cf2e0e25bb20dcd39b">00766</a>     <span class="keyword">protected</span> <a class="code" href="classsimple__html__dom.html#afc5e9ce512cd97cf2e0e25bb20dcd39b">$doc</a>;
<a name="l00767"></a><a class="code" href="classsimple__html__dom.html#a128242871482e787498df34c33223f14">00767</a>     <span class="keyword">protected</span> <a class="code" href="classsimple__html__dom.html#a128242871482e787498df34c33223f14">$char</a>;
<a name="l00768"></a><a class="code" href="classsimple__html__dom.html#a256b6d58b346bcd39d5bf5d49de70df2">00768</a>     <span class="keyword">protected</span> <a class="code" href="classsimple__html__dom.html#a256b6d58b346bcd39d5bf5d49de70df2">$cursor</a>;
<a name="l00769"></a><a class="code" href="classsimple__html__dom.html#a4e2313a4b35b72a06ac45fd38960f677">00769</a>     <span class="keyword">protected</span> <a class="code" href="classsimple__html__dom.html#a4e2313a4b35b72a06ac45fd38960f677">$parent</a>;
<a name="l00770"></a><a class="code" href="classsimple__html__dom.html#a2774f17621ab4d3b64411f86c88df407">00770</a>     <span class="keyword">protected</span> <a class="code" href="classsimple__html__dom.html#a2774f17621ab4d3b64411f86c88df407">$noise</a> = array();
<a name="l00771"></a><a class="code" href="classsimple__html__dom.html#ab7f68c12b4913a3685778154760151cd">00771</a>     <span class="keyword">protected</span> <a class="code" href="classsimple__html__dom.html#ab7f68c12b4913a3685778154760151cd">$token_blank</a> = <span class="stringliteral">&quot; \t\r\n&quot;</span>;
<a name="l00772"></a><a class="code" href="classsimple__html__dom.html#a554179de2a5fb6395ce5ec3ff38f3169">00772</a>     <span class="keyword">protected</span> <a class="code" href="classsimple__html__dom.html#a554179de2a5fb6395ce5ec3ff38f3169">$token_equal</a> = <span class="stringliteral">&#39; =/&gt;&#39;</span>;
<a name="l00773"></a><a class="code" href="classsimple__html__dom.html#a6e9298d28dc391aa70939916476fd4d1">00773</a>     <span class="keyword">protected</span> <a class="code" href="classsimple__html__dom.html#a6e9298d28dc391aa70939916476fd4d1">$token_slash</a> = <span class="stringliteral">&quot; /&gt;\r\n\t&quot;</span>;
<a name="l00774"></a><a class="code" href="classsimple__html__dom.html#a0fb7a78d4e17bb7d156df4f5b79c4d30">00774</a>     <span class="keyword">protected</span> <a class="code" href="classsimple__html__dom.html#a0fb7a78d4e17bb7d156df4f5b79c4d30">$token_attr</a> = <span class="stringliteral">&#39; &gt;&#39;</span>;
<a name="l00775"></a><a class="code" href="classsimple__html__dom.html#ad6b00a32790b456a2f1668b2010a262e">00775</a>     <span class="keyword">protected</span> <a class="code" href="classsimple__html__dom.html#ad6b00a32790b456a2f1668b2010a262e">$_charset</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00776"></a><a class="code" href="classsimple__html__dom.html#a8f23f043ea2af2e56d97bebf17347f23">00776</a>     <span class="keyword">protected</span> <a class="code" href="classsimple__html__dom.html#a8f23f043ea2af2e56d97bebf17347f23">$_target_charset</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00777"></a><a class="code" href="classsimple__html__dom.html#abd3661f931d84bc5e904cfd8e8e00833">00777</a>     <span class="keyword">protected</span> <a class="code" href="classsimple__html__dom.html#abd3661f931d84bc5e904cfd8e8e00833">$default_br_text</a> = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00778"></a>00778 
<a name="l00779"></a>00779     <span class="comment">// use isset instead of in_array, performance boost about 30%...</span>
<a name="l00780"></a><a class="code" href="classsimple__html__dom.html#af36f0e679f54f7ee558dd5b96d4b8727">00780</a>     <span class="keyword">protected</span> <a class="code" href="classsimple__html__dom.html#af36f0e679f54f7ee558dd5b96d4b8727">$self_closing_tags</a> = array(<span class="stringliteral">&#39;img&#39;</span>=&gt;1, <span class="stringliteral">&#39;br&#39;</span>=&gt;1, <span class="stringliteral">&#39;input&#39;</span>=&gt;1, <span class="stringliteral">&#39;meta&#39;</span>=&gt;1, <span class="stringliteral">&#39;link&#39;</span>=&gt;1, <span class="stringliteral">&#39;hr&#39;</span>=&gt;1, <span class="stringliteral">&#39;base&#39;</span>=&gt;1, <span class="stringliteral">&#39;embed&#39;</span>=&gt;1, <span class="stringliteral">&#39;spacer&#39;</span>=&gt;1);
<a name="l00781"></a><a class="code" href="classsimple__html__dom.html#ac513b8dc3142f886d0609b7893fe6026">00781</a>     <span class="keyword">protected</span> <a class="code" href="classsimple__html__dom.html#ac513b8dc3142f886d0609b7893fe6026">$block_tags</a> = array(<span class="stringliteral">&#39;root&#39;</span>=&gt;1, <span class="stringliteral">&#39;body&#39;</span>=&gt;1, <span class="stringliteral">&#39;form&#39;</span>=&gt;1, <span class="stringliteral">&#39;div&#39;</span>=&gt;1, <span class="stringliteral">&#39;span&#39;</span>=&gt;1, <span class="stringliteral">&#39;table&#39;</span>=&gt;1);
<a name="l00782"></a>00782     <span class="comment">// Known sourceforge issue #2977341</span>
<a name="l00783"></a>00783     <span class="comment">// B tags that are not closed cause us to return everything to the end of the document.</span>
<a name="l00784"></a><a class="code" href="classsimple__html__dom.html#a0aa8137deceff2940ae24f30bdb37379">00784</a>     <span class="keyword">protected</span> <a class="code" href="classsimple__html__dom.html#a0aa8137deceff2940ae24f30bdb37379">$optional_closing_tags</a> = array(
<a name="l00785"></a>00785         <span class="stringliteral">&#39;tr&#39;</span>=&gt;array(<span class="stringliteral">&#39;tr&#39;</span>=&gt;1, <span class="stringliteral">&#39;td&#39;</span>=&gt;1, <span class="stringliteral">&#39;th&#39;</span>=&gt;1),
<a name="l00786"></a>00786         <span class="stringliteral">&#39;th&#39;</span>=&gt;array(<span class="stringliteral">&#39;th&#39;</span>=&gt;1),
<a name="l00787"></a>00787         <span class="stringliteral">&#39;td&#39;</span>=&gt;array(<span class="stringliteral">&#39;td&#39;</span>=&gt;1),
<a name="l00788"></a>00788         <span class="stringliteral">&#39;li&#39;</span>=&gt;array(<span class="stringliteral">&#39;li&#39;</span>=&gt;1),
<a name="l00789"></a>00789         <span class="stringliteral">&#39;dt&#39;</span>=&gt;array(<span class="stringliteral">&#39;dt&#39;</span>=&gt;1, <span class="stringliteral">&#39;dd&#39;</span>=&gt;1),
<a name="l00790"></a>00790         <span class="stringliteral">&#39;dd&#39;</span>=&gt;array(<span class="stringliteral">&#39;dd&#39;</span>=&gt;1, <span class="stringliteral">&#39;dt&#39;</span>=&gt;1),
<a name="l00791"></a>00791         <span class="stringliteral">&#39;dl&#39;</span>=&gt;array(<span class="stringliteral">&#39;dd&#39;</span>=&gt;1, <span class="stringliteral">&#39;dt&#39;</span>=&gt;1),
<a name="l00792"></a>00792         <span class="charliteral">&#39;p&#39;</span>=&gt;array(<span class="charliteral">&#39;p&#39;</span>=&gt;1),
<a name="l00793"></a>00793         <span class="stringliteral">&#39;nobr&#39;</span>=&gt;array(<span class="stringliteral">&#39;nobr&#39;</span>=&gt;1),
<a name="l00794"></a>00794         <span class="charliteral">&#39;b&#39;</span>=&gt;array(<span class="charliteral">&#39;b&#39;</span>=&gt;1),
<a name="l00795"></a>00795     );
<a name="l00796"></a>00796 
<a name="l00797"></a><a class="code" href="classsimple__html__dom.html#a1476a2c0f66c39d409155c5a88477b04">00797</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a1476a2c0f66c39d409155c5a88477b04">__construct</a>($str=null, <a class="code" href="classsimple__html__dom.html#a8e20508789d34bc35e3b00ad58159d1c">$lowercase</a>=<span class="keyword">true</span>, $forceTagsClosed=<span class="keyword">true</span>, $target_charset=<a class="code" href="simple__html__dom_8php.html#a68caecf7e025598ca05828747d2952e9">DEFAULT_TARGET_CHARSET</a>, $stripRN=<span class="keyword">true</span>, $defaultBRText=<a class="code" href="simple__html__dom_8php.html#af934fcb7094d73cbf2d81fe142915c07">DEFAULT_BR_TEXT</a>) {
<a name="l00798"></a>00798         <span class="keywordflow">if</span> ($str) {
<a name="l00799"></a>00799             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&quot;/^http:\/\//i&quot;</span>,$str) || is_file($str))
<a name="l00800"></a>00800                 $this-&gt;<a class="code" href="classsimple__html__dom.html#acbf45344758b1a521534cc9cc8ebc5f5">load_file</a>($str);
<a name="l00801"></a>00801             <span class="keywordflow">else</span>
<a name="l00802"></a>00802                 $this-&gt;<a class="code" href="classsimple__html__dom.html#a456c29e9a8c88882f2f4b39524cd0bdb">load</a>($str, <a class="code" href="classsimple__html__dom.html#a8e20508789d34bc35e3b00ad58159d1c">$lowercase</a>, $stripRN, $defaultBRText);
<a name="l00803"></a>00803         }
<a name="l00804"></a>00804         <span class="comment">// Forcing tags to be closed implies that we don&#39;t trust the html, but it can lead to parsing errors if we SHOULD trust the html.</span>
<a name="l00805"></a>00805         <span class="keywordflow">if</span> (!$forceTagsClosed) {
<a name="l00806"></a>00806             $this-&gt;optional_closing_array=array();
<a name="l00807"></a>00807         }
<a name="l00808"></a>00808         $this-&gt;_target_charset = $target_charset;
<a name="l00809"></a>00809     }
<a name="l00810"></a>00810 
<a name="l00811"></a><a class="code" href="classsimple__html__dom.html#a421831a265621325e1fdd19aace0c758">00811</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a421831a265621325e1fdd19aace0c758">__destruct</a>() {
<a name="l00812"></a>00812         $this-&gt;<a class="code" href="classsimple__html__dom.html#aa821bec12eaa7e0f649397c9675ff505">clear</a>();
<a name="l00813"></a>00813     }
<a name="l00814"></a>00814 
<a name="l00815"></a>00815     <span class="comment">// load html from string</span>
<a name="l00816"></a><a class="code" href="classsimple__html__dom.html#a456c29e9a8c88882f2f4b39524cd0bdb">00816</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a456c29e9a8c88882f2f4b39524cd0bdb">load</a>($str, <a class="code" href="classsimple__html__dom.html#a8e20508789d34bc35e3b00ad58159d1c">$lowercase</a>=<span class="keyword">true</span>, $stripRN=<span class="keyword">true</span>, $defaultBRText=<a class="code" href="simple__html__dom_8php.html#af934fcb7094d73cbf2d81fe142915c07">DEFAULT_BR_TEXT</a>) {
<a name="l00817"></a>00817         global $debugObject;
<a name="l00818"></a>00818 
<a name="l00819"></a>00819         <span class="comment">// prepare</span>
<a name="l00820"></a>00820         $this-&gt;<a class="code" href="classsimple__html__dom.html#a25f8906a042cfa75b5b0eb0f0982acd2">prepare</a>($str, <a class="code" href="classsimple__html__dom.html#a8e20508789d34bc35e3b00ad58159d1c">$lowercase</a>, $stripRN, $defaultBRText);
<a name="l00821"></a>00821         <span class="comment">// strip out comments</span>
<a name="l00822"></a>00822         $this-&gt;<a class="code" href="classsimple__html__dom.html#a5bf6f05cd9b47a87912de85a6a556b6b">remove_noise</a>(<span class="stringliteral">&quot;&#39;&lt;!--(.*?)--&gt;&#39;is&quot;</span>);
<a name="l00823"></a>00823         <span class="comment">// strip out cdata</span>
<a name="l00824"></a>00824         $this-&gt;<a class="code" href="classsimple__html__dom.html#a5bf6f05cd9b47a87912de85a6a556b6b">remove_noise</a>(<span class="stringliteral">&quot;&#39;&lt;!\[CDATA\[(.*?)\]\]&gt;&#39;is&quot;</span>, <span class="keyword">true</span>);
<a name="l00825"></a>00825         <span class="comment">// Per sourceforge http://sourceforge.net/tracker/?func=detail&amp;aid=2949097&amp;group_id=218559&amp;atid=1044037</span>
<a name="l00826"></a>00826         <span class="comment">// Script tags removal now preceeds style tag removal.</span>
<a name="l00827"></a>00827         <span class="comment">// strip out &lt;script&gt; tags</span>
<a name="l00828"></a>00828         $this-&gt;<a class="code" href="classsimple__html__dom.html#a5bf6f05cd9b47a87912de85a6a556b6b">remove_noise</a>(<span class="stringliteral">&quot;&#39;&lt;\s*script[^&gt;]*[^/]&gt;(.*?)&lt;\s*/\s*script\s*&gt;&#39;is&quot;</span>);
<a name="l00829"></a>00829         $this-&gt;<a class="code" href="classsimple__html__dom.html#a5bf6f05cd9b47a87912de85a6a556b6b">remove_noise</a>(<span class="stringliteral">&quot;&#39;&lt;\s*script\s*&gt;(.*?)&lt;\s*/\s*script\s*&gt;&#39;is&quot;</span>);
<a name="l00830"></a>00830         <span class="comment">// strip out &lt;style&gt; tags</span>
<a name="l00831"></a>00831         $this-&gt;<a class="code" href="classsimple__html__dom.html#a5bf6f05cd9b47a87912de85a6a556b6b">remove_noise</a>(<span class="stringliteral">&quot;&#39;&lt;\s*style[^&gt;]*[^/]&gt;(.*?)&lt;\s*/\s*style\s*&gt;&#39;is&quot;</span>);
<a name="l00832"></a>00832         $this-&gt;<a class="code" href="classsimple__html__dom.html#a5bf6f05cd9b47a87912de85a6a556b6b">remove_noise</a>(<span class="stringliteral">&quot;&#39;&lt;\s*style\s*&gt;(.*?)&lt;\s*/\s*style\s*&gt;&#39;is&quot;</span>);
<a name="l00833"></a>00833         <span class="comment">// strip out preformatted tags</span>
<a name="l00834"></a>00834         $this-&gt;<a class="code" href="classsimple__html__dom.html#a5bf6f05cd9b47a87912de85a6a556b6b">remove_noise</a>(<span class="stringliteral">&quot;&#39;&lt;\s*(?:code)[^&gt;]*&gt;(.*?)&lt;\s*/\s*(?:code)\s*&gt;&#39;is&quot;</span>);
<a name="l00835"></a>00835         <span class="comment">// strip out server side scripts</span>
<a name="l00836"></a>00836         $this-&gt;<a class="code" href="classsimple__html__dom.html#a5bf6f05cd9b47a87912de85a6a556b6b">remove_noise</a>(<span class="stringliteral">&quot;&#39;(&lt;\?)(.*?)(\?&gt;)&#39;s&quot;</span>, <span class="keyword">true</span>);
<a name="l00837"></a>00837         <span class="comment">// strip smarty scripts</span>
<a name="l00838"></a>00838         $this-&gt;<a class="code" href="classsimple__html__dom.html#a5bf6f05cd9b47a87912de85a6a556b6b">remove_noise</a>(<span class="stringliteral">&quot;&#39;(\{\w)(.*?)(\})&#39;s&quot;</span>, <span class="keyword">true</span>);
<a name="l00839"></a>00839 
<a name="l00840"></a>00840         <span class="comment">// parsing</span>
<a name="l00841"></a>00841         <span class="keywordflow">while</span> ($this-&gt;<a class="code" href="classsimple__html__dom.html#a38d99acc70a1d8fd8f94455743b2d237">parse</a>());
<a name="l00842"></a>00842         <span class="comment">// end</span>
<a name="l00843"></a>00843         $this-&gt;root-&gt;_[<a class="code" href="simple__html__dom_8php.html#a13c34186f5e8fa871944f1d39f893ca4">HDOM_INFO_END</a>] = $this-&gt;cursor;
<a name="l00844"></a>00844         $this-&gt;<a class="code" href="classsimple__html__dom.html#a519f20b58429f11fb3c3839efcc7f484">parse_charset</a>();
<a name="l00845"></a>00845     }
<a name="l00846"></a>00846 
<a name="l00847"></a>00847     <span class="comment">// load html from file</span>
<a name="l00848"></a><a class="code" href="classsimple__html__dom.html#acbf45344758b1a521534cc9cc8ebc5f5">00848</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#acbf45344758b1a521534cc9cc8ebc5f5">load_file</a>() {
<a name="l00849"></a>00849         $args = func_get_args();
<a name="l00850"></a>00850         $this-&gt;<a class="code" href="classsimple__html__dom.html#a456c29e9a8c88882f2f4b39524cd0bdb">load</a>(call_user_func_array(<span class="stringliteral">&#39;file_get_contents&#39;</span>, $args), <span class="keyword">true</span>);
<a name="l00851"></a>00851         <span class="comment">// Per the simple_html_dom repositiry this is a planned upgrade to the codebase.</span>
<a name="l00852"></a>00852         <span class="comment">// Throw an error if we can&#39;t properly load the dom.</span>
<a name="l00853"></a>00853         <span class="keywordflow">if</span> (($error=error_get_last())!==null) {
<a name="l00854"></a>00854             $this-&gt;<a class="code" href="classsimple__html__dom.html#aa821bec12eaa7e0f649397c9675ff505">clear</a>();
<a name="l00855"></a>00855             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00856"></a>00856         }
<a name="l00857"></a>00857     }
<a name="l00858"></a>00858 
<a name="l00859"></a>00859     <span class="comment">// set callback function</span>
<a name="l00860"></a><a class="code" href="classsimple__html__dom.html#a40e8b7bf2a1b1acc56b82f9221fb9266">00860</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a40e8b7bf2a1b1acc56b82f9221fb9266">set_callback</a>($function_name) {
<a name="l00861"></a>00861         $this-&gt;callback = $function_name;
<a name="l00862"></a>00862     }
<a name="l00863"></a>00863 
<a name="l00864"></a>00864     <span class="comment">// remove callback function</span>
<a name="l00865"></a><a class="code" href="classsimple__html__dom.html#a0af324763ae6d1a475455af727fc5037">00865</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a0af324763ae6d1a475455af727fc5037">remove_callback</a>() {
<a name="l00866"></a>00866         $this-&gt;callback = null;
<a name="l00867"></a>00867     }
<a name="l00868"></a>00868 
<a name="l00869"></a>00869     <span class="comment">// save dom as string</span>
<a name="l00870"></a><a class="code" href="classsimple__html__dom.html#a6e80614bedc0513a210906c36f608fa8">00870</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a6e80614bedc0513a210906c36f608fa8">save</a>($filepath=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l00871"></a>00871         $ret = $this-&gt;root-&gt;innertext();
<a name="l00872"></a>00872         <span class="keywordflow">if</span> ($filepath!==<span class="stringliteral">&#39;&#39;</span>) file_put_contents($filepath, $ret, LOCK_EX);
<a name="l00873"></a>00873         <span class="keywordflow">return</span> $ret;
<a name="l00874"></a>00874     }
<a name="l00875"></a>00875 
<a name="l00876"></a>00876     <span class="comment">// find dom node by css selector</span>
<a name="l00877"></a>00877     <span class="comment">// Paperg - allow us to specify that we want case insensitive testing of the value of the selector.</span>
<a name="l00878"></a><a class="code" href="classsimple__html__dom.html#afbf375e355aa32c25f7e389a04ddced0">00878</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#afbf375e355aa32c25f7e389a04ddced0">find</a>($selector, $idx=null, <a class="code" href="classsimple__html__dom.html#a8e20508789d34bc35e3b00ad58159d1c">$lowercase</a>=<span class="keyword">false</span>) {
<a name="l00879"></a>00879         <span class="keywordflow">return</span> $this-&gt;root-&gt;find($selector, $idx, <a class="code" href="classsimple__html__dom.html#a8e20508789d34bc35e3b00ad58159d1c">$lowercase</a>);
<a name="l00880"></a>00880     }
<a name="l00881"></a>00881 
<a name="l00882"></a>00882     <span class="comment">// clean up memory due to php5 circular references memory leak...</span>
<a name="l00883"></a><a class="code" href="classsimple__html__dom.html#aa821bec12eaa7e0f649397c9675ff505">00883</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#aa821bec12eaa7e0f649397c9675ff505">clear</a>() {
<a name="l00884"></a>00884         <span class="keywordflow">foreach</span> ($this-&gt;nodes as $n) {$n-&gt;clear(); $n = null;}
<a name="l00885"></a>00885         <span class="comment">// This add next line is documented in the sourceforge repository. 2977248 as a fix for ongoing memory leaks that occur even with the use of clear.</span>
<a name="l00886"></a>00886         <span class="keywordflow">if</span> (isset($this-&gt;children)) <span class="keywordflow">foreach</span> ($this-&gt;children as $n) {$n-&gt;clear(); $n = null;}
<a name="l00887"></a>00887         <span class="keywordflow">if</span> (isset($this-&gt;parent)) {$this-&gt;parent-&gt;clear(); unset($this-&gt;parent);}
<a name="l00888"></a>00888         <span class="keywordflow">if</span> (isset($this-&gt;root)) {$this-&gt;root-&gt;clear(); unset($this-&gt;root);}
<a name="l00889"></a>00889         unset($this-&gt;doc);
<a name="l00890"></a>00890         unset($this-&gt;noise);
<a name="l00891"></a>00891     }
<a name="l00892"></a>00892 
<a name="l00893"></a><a class="code" href="classsimple__html__dom.html#ad2a305d3f759f9c444d5b2e686586598">00893</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#ad2a305d3f759f9c444d5b2e686586598">dump</a>($show_attr=<span class="keyword">true</span>) {
<a name="l00894"></a>00894         $this-&gt;root-&gt;dump($show_attr);
<a name="l00895"></a>00895     }
<a name="l00896"></a>00896 
<a name="l00897"></a>00897     <span class="comment">// prepare HTML data and init everything</span>
<a name="l00898"></a><a class="code" href="classsimple__html__dom.html#a25f8906a042cfa75b5b0eb0f0982acd2">00898</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a25f8906a042cfa75b5b0eb0f0982acd2">prepare</a>($str, <a class="code" href="classsimple__html__dom.html#a8e20508789d34bc35e3b00ad58159d1c">$lowercase</a>=<span class="keyword">true</span>, $stripRN=<span class="keyword">true</span>, $defaultBRText=<a class="code" href="simple__html__dom_8php.html#af934fcb7094d73cbf2d81fe142915c07">DEFAULT_BR_TEXT</a>) {
<a name="l00899"></a>00899         $this-&gt;<a class="code" href="classsimple__html__dom.html#aa821bec12eaa7e0f649397c9675ff505">clear</a>();
<a name="l00900"></a>00900 
<a name="l00901"></a>00901         <span class="comment">// set the length of content before we do anything to it.</span>
<a name="l00902"></a>00902         $this-&gt;size = strlen($str);
<a name="l00903"></a>00903 
<a name="l00904"></a>00904         <span class="comment">//before we save the string as the doc...  strip out the \r \n&#39;s if we are told to.</span>
<a name="l00905"></a>00905         <span class="keywordflow">if</span> ($stripRN) {
<a name="l00906"></a>00906             $str = str_replace(<span class="stringliteral">&quot;\r&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, $str);
<a name="l00907"></a>00907             $str = str_replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, $str);
<a name="l00908"></a>00908         }
<a name="l00909"></a>00909 
<a name="l00910"></a>00910         $this-&gt;doc = $str;
<a name="l00911"></a>00911         $this-&gt;pos = 0;
<a name="l00912"></a>00912         $this-&gt;cursor = 1;
<a name="l00913"></a>00913         $this-&gt;noise = array();
<a name="l00914"></a>00914         $this-&gt;nodes = array();
<a name="l00915"></a>00915         $this-&gt;lowercase = <a class="code" href="classsimple__html__dom.html#a8e20508789d34bc35e3b00ad58159d1c">$lowercase</a>;
<a name="l00916"></a>00916         $this-&gt;default_br_text = $defaultBRText;
<a name="l00917"></a>00917         $this-&gt;root = <span class="keyword">new</span> <a class="code" href="classsimple__html__dom__node.html">simple_html_dom_node</a>($this);
<a name="l00918"></a>00918         $this-&gt;root-&gt;tag = <span class="stringliteral">&#39;root&#39;</span>;
<a name="l00919"></a>00919         $this-&gt;root-&gt;_[<a class="code" href="simple__html__dom_8php.html#a18bc2baf215f9fa2889795e860e30a8f">HDOM_INFO_BEGIN</a>] = -1;
<a name="l00920"></a>00920         $this-&gt;root-&gt;nodetype = <a class="code" href="simple__html__dom_8php.html#a5a01433d1f7448627983b4210646875a">HDOM_TYPE_ROOT</a>;
<a name="l00921"></a>00921         $this-&gt;parent = $this-&gt;root;
<a name="l00922"></a>00922         <span class="keywordflow">if</span> ($this-&gt;size&gt;0) $this-&gt;<span class="keywordtype">char</span> = $this-&gt;doc[0];
<a name="l00923"></a>00923     }
<a name="l00924"></a>00924 
<a name="l00925"></a>00925     <span class="comment">// parse html content</span>
<a name="l00926"></a><a class="code" href="classsimple__html__dom.html#a38d99acc70a1d8fd8f94455743b2d237">00926</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a38d99acc70a1d8fd8f94455743b2d237">parse</a>() {
<a name="l00927"></a>00927         <span class="keywordflow">if</span> (($s = $this-&gt;<a class="code" href="classsimple__html__dom.html#a0dcd73e05f3cee1eafe3ec6fa347c36b">copy_until_char</a>(<span class="charliteral">&#39;&lt;&#39;</span>))===<span class="stringliteral">&#39;&#39;</span>)
<a name="l00928"></a>00928             <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom.html#a11913c53d09e73dc367062ee54abde20">read_tag</a>();
<a name="l00929"></a>00929 
<a name="l00930"></a>00930         <span class="comment">// text</span>
<a name="l00931"></a>00931         $node = <span class="keyword">new</span> <a class="code" href="classsimple__html__dom__node.html">simple_html_dom_node</a>($this);
<a name="l00932"></a>00932         ++$this-&gt;cursor;
<a name="l00933"></a>00933         $node-&gt;_[<a class="code" href="simple__html__dom_8php.html#a9750656802ea115d7b3797e22cf2f07e">HDOM_INFO_TEXT</a>] = $s;
<a name="l00934"></a>00934         $this-&gt;<a class="code" href="classsimple__html__dom.html#a19edb141f64d5d085874f2e75e0aa333">link_nodes</a>($node, <span class="keyword">false</span>);
<a name="l00935"></a>00935         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00936"></a>00936     }
<a name="l00937"></a>00937 
<a name="l00938"></a>00938     <span class="comment">// PAPERG - dkchou - added this to try to identify the character set of the page we have just parsed so we know better how to spit it out later.</span>
<a name="l00939"></a>00939     <span class="comment">// NOTE:  IF you provide a routine called get_last_retrieve_url_contents_content_type which returns the CURLINFO_CONTENT_TYPE fromt he last curl_exec</span>
<a name="l00940"></a>00940     <span class="comment">// (or the content_type header fromt eh last transfer), we will parse THAT, and if a charset is specified, we will use it over any other mechanism.</span>
<a name="l00941"></a><a class="code" href="classsimple__html__dom.html#a519f20b58429f11fb3c3839efcc7f484">00941</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a519f20b58429f11fb3c3839efcc7f484">parse_charset</a>()
<a name="l00942"></a>00942     {
<a name="l00943"></a>00943         global $debugObject;
<a name="l00944"></a>00944 
<a name="l00945"></a>00945         <a class="code" href="extensions_2_x_m_l_data_source_2lib_2app_2index_8php.html#af10158dd74b75f1d337e83102d6b82ce">$charset</a> = null;
<a name="l00946"></a>00946 
<a name="l00947"></a>00947         <span class="keywordflow">if</span> (function_exists(<span class="stringliteral">&#39;get_last_retrieve_url_contents_content_type&#39;</span>))
<a name="l00948"></a>00948         {
<a name="l00949"></a>00949             $contentTypeHeader = get_last_retrieve_url_contents_content_type();
<a name="l00950"></a>00950             $success = preg_match(<span class="stringliteral">&#39;/charset=(.+)/&#39;</span>, $contentTypeHeader, $matches);
<a name="l00951"></a>00951             <span class="keywordflow">if</span> ($success)
<a name="l00952"></a>00952             {
<a name="l00953"></a>00953                 <a class="code" href="extensions_2_x_m_l_data_source_2lib_2app_2index_8php.html#af10158dd74b75f1d337e83102d6b82ce">$charset</a> = $matches[1];
<a name="l00954"></a>00954                 <span class="keywordflow">if</span> (is_object($debugObject)) {$debugObject-&gt;debugLog(2, <span class="stringliteral">&#39;header content-type found charset of: &#39;</span> . <a class="code" href="extensions_2_x_m_l_data_source_2lib_2app_2index_8php.html#af10158dd74b75f1d337e83102d6b82ce">$charset</a>);}
<a name="l00955"></a>00955             }
<a name="l00956"></a>00956 
<a name="l00957"></a>00957         }
<a name="l00958"></a>00958 
<a name="l00959"></a>00959         <span class="keywordflow">if</span> (empty(<a class="code" href="extensions_2_x_m_l_data_source_2lib_2app_2index_8php.html#af10158dd74b75f1d337e83102d6b82ce">$charset</a>))
<a name="l00960"></a>00960         {
<a name="l00961"></a>00961             $el = $this-&gt;root-&gt;find(<span class="stringliteral">&#39;meta[http-equiv=Content-Type]&#39;</span>,0);
<a name="l00962"></a>00962             <span class="keywordflow">if</span> (!empty($el))
<a name="l00963"></a>00963             {
<a name="l00964"></a>00964                 $fullvalue = $el-&gt;content;
<a name="l00965"></a>00965                 <span class="keywordflow">if</span> (is_object($debugObject)) {$debugObject-&gt;debugLog(2, <span class="stringliteral">&#39;meta content-type tag found&#39;</span> . $fullValue);}
<a name="l00966"></a>00966 
<a name="l00967"></a>00967                 <span class="keywordflow">if</span> (!empty($fullvalue))
<a name="l00968"></a>00968                 {
<a name="l00969"></a>00969                     $success = preg_match(<span class="stringliteral">&#39;/charset=(.+)/&#39;</span>, $fullvalue, $matches);
<a name="l00970"></a>00970                     <span class="keywordflow">if</span> ($success)
<a name="l00971"></a>00971                     {
<a name="l00972"></a>00972                         <a class="code" href="extensions_2_x_m_l_data_source_2lib_2app_2index_8php.html#af10158dd74b75f1d337e83102d6b82ce">$charset</a> = $matches[1];
<a name="l00973"></a>00973                     }
<a name="l00974"></a>00974                     <span class="keywordflow">else</span>
<a name="l00975"></a>00975                     {
<a name="l00976"></a>00976                         <span class="comment">// If there is a meta tag, and they don&#39;t specify the character set, research says that it&#39;s typically ISO-8859-1</span>
<a name="l00977"></a>00977                         <span class="keywordflow">if</span> (is_object($debugObject)) {$debugObject-&gt;debugLog(2, <span class="stringliteral">&#39;meta content-type tag couldn\&#39;t be parsed. using iso-8859 default.&#39;</span>);}
<a name="l00978"></a>00978                         <a class="code" href="extensions_2_x_m_l_data_source_2lib_2app_2index_8php.html#af10158dd74b75f1d337e83102d6b82ce">$charset</a> = <span class="stringliteral">&#39;ISO-8859-1&#39;</span>;
<a name="l00979"></a>00979                     }
<a name="l00980"></a>00980                 }
<a name="l00981"></a>00981             }
<a name="l00982"></a>00982         }
<a name="l00983"></a>00983 
<a name="l00984"></a>00984         <span class="comment">// If we couldn&#39;t find a charset above, then lets try to detect one based on the text we got...</span>
<a name="l00985"></a>00985         <span class="keywordflow">if</span> (empty(<a class="code" href="extensions_2_x_m_l_data_source_2lib_2app_2index_8php.html#af10158dd74b75f1d337e83102d6b82ce">$charset</a>))
<a name="l00986"></a>00986         {
<a name="l00987"></a>00987             <span class="comment">// Have php try to detect the encoding from the text given to us.</span>
<a name="l00988"></a>00988             <a class="code" href="extensions_2_x_m_l_data_source_2lib_2app_2index_8php.html#af10158dd74b75f1d337e83102d6b82ce">$charset</a> = mb_detect_encoding($this-&gt;root-&gt;plaintext . <span class="stringliteral">&quot;ascii&quot;</span>, $encoding_list = array( <span class="stringliteral">&quot;UTF-8&quot;</span>, <span class="stringliteral">&quot;CP1252&quot;</span> ) );
<a name="l00989"></a>00989             <span class="keywordflow">if</span> (is_object($debugObject)) {$debugObject-&gt;debugLog(2, <span class="stringliteral">&#39;mb_detect found: &#39;</span> . <a class="code" href="extensions_2_x_m_l_data_source_2lib_2app_2index_8php.html#af10158dd74b75f1d337e83102d6b82ce">$charset</a>);}
<a name="l00990"></a>00990 
<a name="l00991"></a>00991             <span class="comment">// and if this doesn&#39;t work...  then we need to just wrongheadedly assume it&#39;s UTF-8 so that we can move on - cause this will usually give us most of what we need...</span>
<a name="l00992"></a>00992             <span class="keywordflow">if</span> (<a class="code" href="extensions_2_x_m_l_data_source_2lib_2app_2index_8php.html#af10158dd74b75f1d337e83102d6b82ce">$charset</a> === <span class="keyword">false</span>)
<a name="l00993"></a>00993             {
<a name="l00994"></a>00994                 <span class="keywordflow">if</span> (is_object($debugObject)) {$debugObject-&gt;debugLog(2, <span class="stringliteral">&#39;since mb_detect failed - using default of utf-8&#39;</span>);}
<a name="l00995"></a>00995                 <a class="code" href="extensions_2_x_m_l_data_source_2lib_2app_2index_8php.html#af10158dd74b75f1d337e83102d6b82ce">$charset</a> = <span class="stringliteral">&#39;UTF-8&#39;</span>;
<a name="l00996"></a>00996             }
<a name="l00997"></a>00997         }
<a name="l00998"></a>00998 
<a name="l00999"></a>00999         <span class="comment">// Since CP1252 is a superset, if we get one of it&#39;s subsets, we want it instead.</span>
<a name="l01000"></a>01000         <span class="keywordflow">if</span> ((strtolower(<a class="code" href="extensions_2_x_m_l_data_source_2lib_2app_2index_8php.html#af10158dd74b75f1d337e83102d6b82ce">$charset</a>) == strtolower(<span class="stringliteral">&#39;ISO-8859-1&#39;</span>)) || (strtolower(<a class="code" href="extensions_2_x_m_l_data_source_2lib_2app_2index_8php.html#af10158dd74b75f1d337e83102d6b82ce">$charset</a>) == strtolower(<span class="stringliteral">&#39;Latin1&#39;</span>)) || (strtolower(<a class="code" href="extensions_2_x_m_l_data_source_2lib_2app_2index_8php.html#af10158dd74b75f1d337e83102d6b82ce">$charset</a>) == strtolower(<span class="stringliteral">&#39;Latin-1&#39;</span>)))
<a name="l01001"></a>01001         {
<a name="l01002"></a>01002             <span class="keywordflow">if</span> (is_object($debugObject)) {$debugObject-&gt;debugLog(2, <span class="stringliteral">&#39;replacing &#39;</span> . <a class="code" href="extensions_2_x_m_l_data_source_2lib_2app_2index_8php.html#af10158dd74b75f1d337e83102d6b82ce">$charset</a> . <span class="stringliteral">&#39; with CP1252 as its a superset&#39;</span>);}
<a name="l01003"></a>01003             <a class="code" href="extensions_2_x_m_l_data_source_2lib_2app_2index_8php.html#af10158dd74b75f1d337e83102d6b82ce">$charset</a> = <span class="stringliteral">&#39;CP1252&#39;</span>;
<a name="l01004"></a>01004         }
<a name="l01005"></a>01005 
<a name="l01006"></a>01006         <span class="keywordflow">if</span> (is_object($debugObject)) {$debugObject-&gt;debugLog(1, <span class="stringliteral">&#39;EXIT - &#39;</span> . <a class="code" href="extensions_2_x_m_l_data_source_2lib_2app_2index_8php.html#af10158dd74b75f1d337e83102d6b82ce">$charset</a>);}
<a name="l01007"></a>01007 
<a name="l01008"></a>01008         <span class="keywordflow">return</span> $this-&gt;_charset = <a class="code" href="extensions_2_x_m_l_data_source_2lib_2app_2index_8php.html#af10158dd74b75f1d337e83102d6b82ce">$charset</a>;
<a name="l01009"></a>01009     }
<a name="l01010"></a>01010 
<a name="l01011"></a>01011     <span class="comment">// read tag info</span>
<a name="l01012"></a><a class="code" href="classsimple__html__dom.html#a11913c53d09e73dc367062ee54abde20">01012</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a11913c53d09e73dc367062ee54abde20">read_tag</a>() {
<a name="l01013"></a>01013         <span class="keywordflow">if</span> ($this-&gt;<span class="keywordtype">char</span>!==<span class="charliteral">&#39;&lt;&#39;</span>) {
<a name="l01014"></a>01014             $this-&gt;root-&gt;_[<a class="code" href="simple__html__dom_8php.html#a13c34186f5e8fa871944f1d39f893ca4">HDOM_INFO_END</a>] = $this-&gt;cursor;
<a name="l01015"></a>01015             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01016"></a>01016         }
<a name="l01017"></a>01017         $begin_tag_pos = $this-&gt;pos;
<a name="l01018"></a>01018         $this-&gt;<span class="keywordtype">char</span> = (++$this-&gt;pos&lt;$this-&gt;size) ? $this-&gt;doc[$this-&gt;pos] : null; <span class="comment">// next</span>
<a name="l01019"></a>01019 
<a name="l01020"></a>01020         <span class="comment">// end tag</span>
<a name="l01021"></a>01021         <span class="keywordflow">if</span> ($this-&gt;<span class="keywordtype">char</span>===<span class="charliteral">&#39;/&#39;</span>) {
<a name="l01022"></a>01022             $this-&gt;<span class="keywordtype">char</span> = (++$this-&gt;pos&lt;$this-&gt;size) ? $this-&gt;doc[$this-&gt;pos] : null; <span class="comment">// next</span>
<a name="l01023"></a>01023             <span class="comment">// This represetns the change in the simple_html_dom trunk from revision 180 to 181.</span>
<a name="l01024"></a>01024             <span class="comment">// $this-&gt;skip($this-&gt;token_blank_t);</span>
<a name="l01025"></a>01025             $this-&gt;<a class="code" href="classsimple__html__dom.html#a83de9b35df2e0857f2b0be5bff3e4960">skip</a>($this-&gt;token_blank);
<a name="l01026"></a>01026             $tag = $this-&gt;<a class="code" href="classsimple__html__dom.html#a0dcd73e05f3cee1eafe3ec6fa347c36b">copy_until_char</a>(<span class="charliteral">&#39;&gt;&#39;</span>);
<a name="l01027"></a>01027 
<a name="l01028"></a>01028             <span class="comment">// skip attributes in end tag</span>
<a name="l01029"></a>01029             <span class="keywordflow">if</span> ((<a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> = strpos($tag, <span class="charliteral">&#39; &#39;</span>))!==<span class="keyword">false</span>)
<a name="l01030"></a>01030                 $tag = substr($tag, 0, <a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>);
<a name="l01031"></a>01031 
<a name="l01032"></a>01032             $parent_lower = strtolower($this-&gt;parent-&gt;tag);
<a name="l01033"></a>01033             $tag_lower = strtolower($tag);
<a name="l01034"></a>01034 
<a name="l01035"></a>01035             <span class="keywordflow">if</span> ($parent_lower!==$tag_lower) {
<a name="l01036"></a>01036                 <span class="keywordflow">if</span> (isset($this-&gt;optional_closing_tags[$parent_lower]) &amp;&amp; isset($this-&gt;block_tags[$tag_lower])) {
<a name="l01037"></a>01037                     $this-&gt;parent-&gt;_[<a class="code" href="simple__html__dom_8php.html#a13c34186f5e8fa871944f1d39f893ca4">HDOM_INFO_END</a>] = 0;
<a name="l01038"></a>01038                     $org_parent = $this-&gt;parent;
<a name="l01039"></a>01039 
<a name="l01040"></a>01040                     <span class="keywordflow">while</span> (($this-&gt;parent-&gt;parent) &amp;&amp; strtolower($this-&gt;parent-&gt;tag)!==$tag_lower)
<a name="l01041"></a>01041                         $this-&gt;parent = $this-&gt;parent-&gt;parent;
<a name="l01042"></a>01042 
<a name="l01043"></a>01043                     <span class="keywordflow">if</span> (strtolower($this-&gt;parent-&gt;tag)!==$tag_lower) {
<a name="l01044"></a>01044                         $this-&gt;parent = $org_parent; <span class="comment">// restore origonal parent</span>
<a name="l01045"></a>01045                         <span class="keywordflow">if</span> ($this-&gt;parent-&gt;parent) $this-&gt;parent = $this-&gt;parent-&gt;parent;
<a name="l01046"></a>01046                         $this-&gt;parent-&gt;_[<a class="code" href="simple__html__dom_8php.html#a13c34186f5e8fa871944f1d39f893ca4">HDOM_INFO_END</a>] = $this-&gt;cursor;
<a name="l01047"></a>01047                         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom.html#a17ff0dd434a94d34972e3c90fbd0d545">as_text_node</a>($tag);
<a name="l01048"></a>01048                     }
<a name="l01049"></a>01049                 }
<a name="l01050"></a>01050                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (($this-&gt;parent-&gt;parent) &amp;&amp; isset($this-&gt;block_tags[$tag_lower])) {
<a name="l01051"></a>01051                     $this-&gt;parent-&gt;_[<a class="code" href="simple__html__dom_8php.html#a13c34186f5e8fa871944f1d39f893ca4">HDOM_INFO_END</a>] = 0;
<a name="l01052"></a>01052                     $org_parent = $this-&gt;parent;
<a name="l01053"></a>01053 
<a name="l01054"></a>01054                     <span class="keywordflow">while</span> (($this-&gt;parent-&gt;parent) &amp;&amp; strtolower($this-&gt;parent-&gt;tag)!==$tag_lower)
<a name="l01055"></a>01055                         $this-&gt;parent = $this-&gt;parent-&gt;parent;
<a name="l01056"></a>01056 
<a name="l01057"></a>01057                     <span class="keywordflow">if</span> (strtolower($this-&gt;parent-&gt;tag)!==$tag_lower) {
<a name="l01058"></a>01058                         $this-&gt;parent = $org_parent; <span class="comment">// restore origonal parent</span>
<a name="l01059"></a>01059                         $this-&gt;parent-&gt;_[<a class="code" href="simple__html__dom_8php.html#a13c34186f5e8fa871944f1d39f893ca4">HDOM_INFO_END</a>] = $this-&gt;cursor;
<a name="l01060"></a>01060                         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom.html#a17ff0dd434a94d34972e3c90fbd0d545">as_text_node</a>($tag);
<a name="l01061"></a>01061                     }
<a name="l01062"></a>01062                 }
<a name="l01063"></a>01063                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (($this-&gt;parent-&gt;parent) &amp;&amp; strtolower($this-&gt;parent-&gt;parent-&gt;tag)===$tag_lower) {
<a name="l01064"></a>01064                     $this-&gt;parent-&gt;_[<a class="code" href="simple__html__dom_8php.html#a13c34186f5e8fa871944f1d39f893ca4">HDOM_INFO_END</a>] = 0;
<a name="l01065"></a>01065                     $this-&gt;parent = $this-&gt;parent-&gt;parent;
<a name="l01066"></a>01066                 }
<a name="l01067"></a>01067                 <span class="keywordflow">else</span>
<a name="l01068"></a>01068                     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom.html#a17ff0dd434a94d34972e3c90fbd0d545">as_text_node</a>($tag);
<a name="l01069"></a>01069             }
<a name="l01070"></a>01070 
<a name="l01071"></a>01071             $this-&gt;parent-&gt;_[<a class="code" href="simple__html__dom_8php.html#a13c34186f5e8fa871944f1d39f893ca4">HDOM_INFO_END</a>] = $this-&gt;cursor;
<a name="l01072"></a>01072             <span class="keywordflow">if</span> ($this-&gt;parent-&gt;parent) $this-&gt;parent = $this-&gt;parent-&gt;parent;
<a name="l01073"></a>01073 
<a name="l01074"></a>01074             $this-&gt;<span class="keywordtype">char</span> = (++$this-&gt;pos&lt;$this-&gt;size) ? $this-&gt;doc[$this-&gt;pos] : null; <span class="comment">// next</span>
<a name="l01075"></a>01075             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01076"></a>01076         }
<a name="l01077"></a>01077 
<a name="l01078"></a>01078         $node = <span class="keyword">new</span> <a class="code" href="classsimple__html__dom__node.html">simple_html_dom_node</a>($this);
<a name="l01079"></a>01079         $node-&gt;_[<a class="code" href="simple__html__dom_8php.html#a18bc2baf215f9fa2889795e860e30a8f">HDOM_INFO_BEGIN</a>] = $this-&gt;cursor;
<a name="l01080"></a>01080         ++$this-&gt;cursor;
<a name="l01081"></a>01081         $tag = $this-&gt;<a class="code" href="classsimple__html__dom.html#a607299237161af9369abc2d2605715d5">copy_until</a>($this-&gt;token_slash);
<a name="l01082"></a>01082         $node-&gt;tag_start = $begin_tag_pos;
<a name="l01083"></a>01083 
<a name="l01084"></a>01084         <span class="comment">// doctype, cdata &amp; comments...</span>
<a name="l01085"></a>01085         <span class="keywordflow">if</span> (isset($tag[0]) &amp;&amp; $tag[0]===<span class="charliteral">&#39;!&#39;</span>) {
<a name="l01086"></a>01086             $node-&gt;_[<a class="code" href="simple__html__dom_8php.html#a9750656802ea115d7b3797e22cf2f07e">HDOM_INFO_TEXT</a>] = <span class="charliteral">&#39;&lt;&#39;</span> . $tag . $this-&gt;<a class="code" href="classsimple__html__dom.html#a0dcd73e05f3cee1eafe3ec6fa347c36b">copy_until_char</a>(<span class="charliteral">&#39;&gt;&#39;</span>);
<a name="l01087"></a>01087 
<a name="l01088"></a>01088             <span class="keywordflow">if</span> (isset($tag[2]) &amp;&amp; $tag[1]===<span class="charliteral">&#39;-&#39;</span> &amp;&amp; $tag[2]===<span class="charliteral">&#39;-&#39;</span>) {
<a name="l01089"></a>01089                 $node-&gt;nodetype = <a class="code" href="simple__html__dom_8php.html#a150eac2dfb509c2e71c53f1a1dbde7ab">HDOM_TYPE_COMMENT</a>;
<a name="l01090"></a>01090                 $node-&gt;tag = <span class="stringliteral">&#39;comment&#39;</span>;
<a name="l01091"></a>01091             } <span class="keywordflow">else</span> {
<a name="l01092"></a>01092                 $node-&gt;nodetype = <a class="code" href="simple__html__dom_8php.html#a9b8b189e64f2ed2f007a3733ac6b92d2">HDOM_TYPE_UNKNOWN</a>;
<a name="l01093"></a>01093                 $node-&gt;tag = <span class="stringliteral">&#39;unknown&#39;</span>;
<a name="l01094"></a>01094             }
<a name="l01095"></a>01095             <span class="keywordflow">if</span> ($this-&gt;<span class="keywordtype">char</span>===<span class="charliteral">&#39;&gt;&#39;</span>) $node-&gt;_[<a class="code" href="simple__html__dom_8php.html#a9750656802ea115d7b3797e22cf2f07e">HDOM_INFO_TEXT</a>].=<span class="charliteral">&#39;&gt;&#39;</span>;
<a name="l01096"></a>01096             $this-&gt;<a class="code" href="classsimple__html__dom.html#a19edb141f64d5d085874f2e75e0aa333">link_nodes</a>($node, <span class="keyword">true</span>);
<a name="l01097"></a>01097             $this-&gt;<span class="keywordtype">char</span> = (++$this-&gt;pos&lt;$this-&gt;size) ? $this-&gt;doc[$this-&gt;pos] : null; <span class="comment">// next</span>
<a name="l01098"></a>01098             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01099"></a>01099         }
<a name="l01100"></a>01100 
<a name="l01101"></a>01101         <span class="comment">// text</span>
<a name="l01102"></a>01102         <span class="keywordflow">if</span> (<a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>=strpos($tag, <span class="charliteral">&#39;&lt;&#39;</span>)!==<span class="keyword">false</span>) {
<a name="l01103"></a>01103             $tag = <span class="charliteral">&#39;&lt;&#39;</span> . substr($tag, 0, -1);
<a name="l01104"></a>01104             $node-&gt;_[<a class="code" href="simple__html__dom_8php.html#a9750656802ea115d7b3797e22cf2f07e">HDOM_INFO_TEXT</a>] = $tag;
<a name="l01105"></a>01105             $this-&gt;<a class="code" href="classsimple__html__dom.html#a19edb141f64d5d085874f2e75e0aa333">link_nodes</a>($node, <span class="keyword">false</span>);
<a name="l01106"></a>01106             $this-&gt;<span class="keywordtype">char</span> = $this-&gt;doc[--$this-&gt;pos]; <span class="comment">// prev</span>
<a name="l01107"></a>01107             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01108"></a>01108         }
<a name="l01109"></a>01109 
<a name="l01110"></a>01110         <span class="keywordflow">if</span> (!preg_match(<span class="stringliteral">&quot;/^[\w-:]+$/&quot;</span>, $tag)) {
<a name="l01111"></a>01111             $node-&gt;_[<a class="code" href="simple__html__dom_8php.html#a9750656802ea115d7b3797e22cf2f07e">HDOM_INFO_TEXT</a>] = <span class="charliteral">&#39;&lt;&#39;</span> . $tag . $this-&gt;<a class="code" href="classsimple__html__dom.html#a607299237161af9369abc2d2605715d5">copy_until</a>(<span class="stringliteral">&#39;&lt;&gt;&#39;</span>);
<a name="l01112"></a>01112             <span class="keywordflow">if</span> ($this-&gt;<span class="keywordtype">char</span>===<span class="charliteral">&#39;&lt;&#39;</span>) {
<a name="l01113"></a>01113                 $this-&gt;<a class="code" href="classsimple__html__dom.html#a19edb141f64d5d085874f2e75e0aa333">link_nodes</a>($node, <span class="keyword">false</span>);
<a name="l01114"></a>01114                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01115"></a>01115             }
<a name="l01116"></a>01116 
<a name="l01117"></a>01117             <span class="keywordflow">if</span> ($this-&gt;<span class="keywordtype">char</span>===<span class="charliteral">&#39;&gt;&#39;</span>) $node-&gt;_[<a class="code" href="simple__html__dom_8php.html#a9750656802ea115d7b3797e22cf2f07e">HDOM_INFO_TEXT</a>].=<span class="charliteral">&#39;&gt;&#39;</span>;
<a name="l01118"></a>01118             $this-&gt;<a class="code" href="classsimple__html__dom.html#a19edb141f64d5d085874f2e75e0aa333">link_nodes</a>($node, <span class="keyword">false</span>);
<a name="l01119"></a>01119             $this-&gt;<span class="keywordtype">char</span> = (++$this-&gt;pos&lt;$this-&gt;size) ? $this-&gt;doc[$this-&gt;pos] : null; <span class="comment">// next</span>
<a name="l01120"></a>01120             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01121"></a>01121         }
<a name="l01122"></a>01122 
<a name="l01123"></a>01123         <span class="comment">// begin tag</span>
<a name="l01124"></a>01124         $node-&gt;nodetype = <a class="code" href="simple__html__dom_8php.html#ae4ed40ab10a6b4194cfc3114bd3902a2">HDOM_TYPE_ELEMENT</a>;
<a name="l01125"></a>01125         $tag_lower = strtolower($tag);
<a name="l01126"></a>01126         $node-&gt;tag = ($this-&gt;lowercase) ? $tag_lower : $tag;
<a name="l01127"></a>01127 
<a name="l01128"></a>01128         <span class="comment">// handle optional closing tags</span>
<a name="l01129"></a>01129         <span class="keywordflow">if</span> (isset($this-&gt;optional_closing_tags[$tag_lower]) ) {
<a name="l01130"></a>01130             <span class="keywordflow">while</span> (isset($this-&gt;optional_closing_tags[$tag_lower][strtolower($this-&gt;parent-&gt;tag)])) {
<a name="l01131"></a>01131                 $this-&gt;parent-&gt;_[<a class="code" href="simple__html__dom_8php.html#a13c34186f5e8fa871944f1d39f893ca4">HDOM_INFO_END</a>] = 0;
<a name="l01132"></a>01132                 $this-&gt;parent = $this-&gt;parent-&gt;parent;
<a name="l01133"></a>01133             }
<a name="l01134"></a>01134             $node-&gt;parent = $this-&gt;parent;
<a name="l01135"></a>01135         }
<a name="l01136"></a>01136 
<a name="l01137"></a>01137         $guard = 0; <span class="comment">// prevent infinity loop</span>
<a name="l01138"></a>01138         $space = array($this-&gt;<a class="code" href="classsimple__html__dom.html#a48081dad72c2e828f05ae7420d95c820">copy_skip</a>($this-&gt;token_blank), <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>);
<a name="l01139"></a>01139 
<a name="l01140"></a>01140         <span class="comment">// attributes</span>
<a name="l01141"></a>01141         <span class="keywordflow">do</span>
<a name="l01142"></a>01142         {
<a name="l01143"></a>01143             <span class="keywordflow">if</span> ($this-&gt;<span class="keywordtype">char</span>!==null &amp;&amp; $space[0]===<span class="stringliteral">&#39;&#39;</span>) <span class="keywordflow">break</span>;
<a name="l01144"></a>01144             $name = $this-&gt;<a class="code" href="classsimple__html__dom.html#a607299237161af9369abc2d2605715d5">copy_until</a>($this-&gt;token_equal);
<a name="l01145"></a>01145             <span class="keywordflow">if</span> ($guard===$this-&gt;pos) {
<a name="l01146"></a>01146                 $this-&gt;<span class="keywordtype">char</span> = (++$this-&gt;pos&lt;$this-&gt;size) ? $this-&gt;doc[$this-&gt;pos] : null; <span class="comment">// next</span>
<a name="l01147"></a>01147                 <span class="keywordflow">continue</span>;
<a name="l01148"></a>01148             }
<a name="l01149"></a>01149             $guard = $this-&gt;pos;
<a name="l01150"></a>01150 
<a name="l01151"></a>01151             <span class="comment">// handle endless &#39;&lt;&#39;</span>
<a name="l01152"></a>01152             <span class="keywordflow">if</span> ($this-&gt;pos&gt;=$this-&gt;size-1 &amp;&amp; $this-&gt;<span class="keywordtype">char</span>!==<span class="charliteral">&#39;&gt;&#39;</span>) {
<a name="l01153"></a>01153                 $node-&gt;nodetype = <a class="code" href="simple__html__dom_8php.html#a5918dbd4526d477e5fe865f333e9538c">HDOM_TYPE_TEXT</a>;
<a name="l01154"></a>01154                 $node-&gt;_[<a class="code" href="simple__html__dom_8php.html#a13c34186f5e8fa871944f1d39f893ca4">HDOM_INFO_END</a>] = 0;
<a name="l01155"></a>01155                 $node-&gt;_[<a class="code" href="simple__html__dom_8php.html#a9750656802ea115d7b3797e22cf2f07e">HDOM_INFO_TEXT</a>] = <span class="charliteral">&#39;&lt;&#39;</span>.$tag . $space[0] . $name;
<a name="l01156"></a>01156                 $node-&gt;tag = <span class="stringliteral">&#39;text&#39;</span>;
<a name="l01157"></a>01157                 $this-&gt;<a class="code" href="classsimple__html__dom.html#a19edb141f64d5d085874f2e75e0aa333">link_nodes</a>($node, <span class="keyword">false</span>);
<a name="l01158"></a>01158                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01159"></a>01159             }
<a name="l01160"></a>01160 
<a name="l01161"></a>01161             <span class="comment">// handle mismatch &#39;&lt;&#39;</span>
<a name="l01162"></a>01162             <span class="keywordflow">if</span> ($this-&gt;doc[$this-&gt;pos-1]==<span class="charliteral">&#39;&lt;&#39;</span>) {
<a name="l01163"></a>01163                 $node-&gt;nodetype = <a class="code" href="simple__html__dom_8php.html#a5918dbd4526d477e5fe865f333e9538c">HDOM_TYPE_TEXT</a>;
<a name="l01164"></a>01164                 $node-&gt;tag = <span class="stringliteral">&#39;text&#39;</span>;
<a name="l01165"></a>01165                 $node-&gt;attr = array();
<a name="l01166"></a>01166                 $node-&gt;_[<a class="code" href="simple__html__dom_8php.html#a13c34186f5e8fa871944f1d39f893ca4">HDOM_INFO_END</a>] = 0;
<a name="l01167"></a>01167                 $node-&gt;_[<a class="code" href="simple__html__dom_8php.html#a9750656802ea115d7b3797e22cf2f07e">HDOM_INFO_TEXT</a>] = substr($this-&gt;doc, $begin_tag_pos, $this-&gt;pos-$begin_tag_pos-1);
<a name="l01168"></a>01168                 $this-&gt;pos -= 2;
<a name="l01169"></a>01169                 $this-&gt;<span class="keywordtype">char</span> = (++$this-&gt;pos&lt;$this-&gt;size) ? $this-&gt;doc[$this-&gt;pos] : null; <span class="comment">// next</span>
<a name="l01170"></a>01170                 $this-&gt;<a class="code" href="classsimple__html__dom.html#a19edb141f64d5d085874f2e75e0aa333">link_nodes</a>($node, <span class="keyword">false</span>);
<a name="l01171"></a>01171                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01172"></a>01172             }
<a name="l01173"></a>01173 
<a name="l01174"></a>01174             <span class="keywordflow">if</span> ($name!==<span class="charliteral">&#39;/&#39;</span> &amp;&amp; $name!==<span class="stringliteral">&#39;&#39;</span>) {
<a name="l01175"></a>01175                 $space[1] = $this-&gt;<a class="code" href="classsimple__html__dom.html#a48081dad72c2e828f05ae7420d95c820">copy_skip</a>($this-&gt;token_blank);
<a name="l01176"></a>01176                 $name = $this-&gt;<a class="code" href="classsimple__html__dom.html#a65768af772cc55c11fc85d4d8697140e">restore_noise</a>($name);
<a name="l01177"></a>01177                 <span class="keywordflow">if</span> ($this-&gt;lowercase) $name = strtolower($name);
<a name="l01178"></a>01178                 <span class="keywordflow">if</span> ($this-&gt;<span class="keywordtype">char</span>===<span class="charliteral">&#39;=&#39;</span>) {
<a name="l01179"></a>01179                     $this-&gt;<span class="keywordtype">char</span> = (++$this-&gt;pos&lt;$this-&gt;size) ? $this-&gt;doc[$this-&gt;pos] : null; <span class="comment">// next</span>
<a name="l01180"></a>01180                     $this-&gt;<a class="code" href="classsimple__html__dom.html#a6d54ee34e0f121005da327b6fe0ab7e4">parse_attr</a>($node, $name, $space);
<a name="l01181"></a>01181                 }
<a name="l01182"></a>01182                 <span class="keywordflow">else</span> {
<a name="l01183"></a>01183                     <span class="comment">//no value attr: nowrap, checked selected...</span>
<a name="l01184"></a>01184                     $node-&gt;_[<a class="code" href="simple__html__dom_8php.html#a1b5b6bdcc0c5597e0e9f0f881ff9ab3c">HDOM_INFO_QUOTE</a>][] = <a class="code" href="simple__html__dom_8php.html#ad587bc18546aacd6ec20b68dc1ef9379">HDOM_QUOTE_NO</a>;
<a name="l01185"></a>01185                     $node-&gt;attr[$name] = <span class="keyword">true</span>;
<a name="l01186"></a>01186                     <span class="keywordflow">if</span> ($this-&gt;<span class="keywordtype">char</span>!=<span class="charliteral">&#39;&gt;&#39;</span>) $this-&gt;<span class="keywordtype">char</span> = $this-&gt;doc[--$this-&gt;pos]; <span class="comment">// prev</span>
<a name="l01187"></a>01187                 }
<a name="l01188"></a>01188                 $node-&gt;_[<a class="code" href="simple__html__dom_8php.html#a05a5288384d1d6deb25e6b5cb67eba9b">HDOM_INFO_SPACE</a>][] = $space;
<a name="l01189"></a>01189                 $space = array($this-&gt;<a class="code" href="classsimple__html__dom.html#a48081dad72c2e828f05ae7420d95c820">copy_skip</a>($this-&gt;token_blank), <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>);
<a name="l01190"></a>01190             }
<a name="l01191"></a>01191             <span class="keywordflow">else</span>
<a name="l01192"></a>01192                 <span class="keywordflow">break</span>;
<a name="l01193"></a>01193         } <span class="keywordflow">while</span> ($this-&gt;<span class="keywordtype">char</span>!==<span class="charliteral">&#39;&gt;&#39;</span> &amp;&amp; $this-&gt;<span class="keywordtype">char</span>!==<span class="charliteral">&#39;/&#39;</span>);
<a name="l01194"></a>01194 
<a name="l01195"></a>01195         $this-&gt;<a class="code" href="classsimple__html__dom.html#a19edb141f64d5d085874f2e75e0aa333">link_nodes</a>($node, <span class="keyword">true</span>);
<a name="l01196"></a>01196         $node-&gt;_[<a class="code" href="simple__html__dom_8php.html#a886a1a55b0a5ea6c66e0eff6fdea87bc">HDOM_INFO_ENDSPACE</a>] = $space[0];
<a name="l01197"></a>01197 
<a name="l01198"></a>01198         <span class="comment">// check self closing</span>
<a name="l01199"></a>01199         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classsimple__html__dom.html#a2df9f8464f8daf439f9fa740ebdc0ede">copy_until_char_escape</a>(<span class="charliteral">&#39;&gt;&#39;</span>)===<span class="charliteral">&#39;/&#39;</span>) {
<a name="l01200"></a>01200             $node-&gt;_[<a class="code" href="simple__html__dom_8php.html#a886a1a55b0a5ea6c66e0eff6fdea87bc">HDOM_INFO_ENDSPACE</a>] .= <span class="charliteral">&#39;/&#39;</span>;
<a name="l01201"></a>01201             $node-&gt;_[<a class="code" href="simple__html__dom_8php.html#a13c34186f5e8fa871944f1d39f893ca4">HDOM_INFO_END</a>] = 0;
<a name="l01202"></a>01202         }
<a name="l01203"></a>01203         <span class="keywordflow">else</span> {
<a name="l01204"></a>01204             <span class="comment">// reset parent</span>
<a name="l01205"></a>01205             <span class="keywordflow">if</span> (!isset($this-&gt;self_closing_tags[strtolower($node-&gt;tag)])) $this-&gt;parent = $node;
<a name="l01206"></a>01206         }
<a name="l01207"></a>01207         $this-&gt;<span class="keywordtype">char</span> = (++$this-&gt;pos&lt;$this-&gt;size) ? $this-&gt;doc[$this-&gt;pos] : null; <span class="comment">// next</span>
<a name="l01208"></a>01208 
<a name="l01209"></a>01209         <span class="comment">// If it&#39;s a BR tag, we need to set it&#39;s text to the default text.</span>
<a name="l01210"></a>01210         <span class="comment">// This way when we see it in plaintext, we can generate formatting that the user wants.</span>
<a name="l01211"></a>01211         <span class="keywordflow">if</span> ($node-&gt;tag == <span class="stringliteral">&quot;br&quot;</span>) {
<a name="l01212"></a>01212             $node-&gt;_[<a class="code" href="simple__html__dom_8php.html#aabbc85c183b84f80d434add6347dd7fd">HDOM_INFO_INNER</a>] = $this-&gt;default_br_text;
<a name="l01213"></a>01213         }
<a name="l01214"></a>01214 
<a name="l01215"></a>01215         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01216"></a>01216     }
<a name="l01217"></a>01217 
<a name="l01218"></a>01218     <span class="comment">// parse attributes</span>
<a name="l01219"></a><a class="code" href="classsimple__html__dom.html#a6d54ee34e0f121005da327b6fe0ab7e4">01219</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a6d54ee34e0f121005da327b6fe0ab7e4">parse_attr</a>($node, $name, &amp;$space) {
<a name="l01220"></a>01220         <span class="comment">// Per sourceforge: http://sourceforge.net/tracker/?func=detail&amp;aid=3061408&amp;group_id=218559&amp;atid=1044037</span>
<a name="l01221"></a>01221         <span class="comment">// If the attribute is already defined inside a tag, only pay atetntion to the first one as opposed to the last one.</span>
<a name="l01222"></a>01222         <span class="keywordflow">if</span> (isset($node-&gt;attr[$name]))
<a name="l01223"></a>01223         {
<a name="l01224"></a>01224             <span class="keywordflow">return</span>;
<a name="l01225"></a>01225         }
<a name="l01226"></a>01226 
<a name="l01227"></a>01227         $space[2] = $this-&gt;<a class="code" href="classsimple__html__dom.html#a48081dad72c2e828f05ae7420d95c820">copy_skip</a>($this-&gt;token_blank);
<a name="l01228"></a>01228         <span class="keywordflow">switch</span> ($this-&gt;<span class="keywordtype">char</span>) {
<a name="l01229"></a>01229             <span class="keywordflow">case</span> <span class="charliteral">&#39;&quot;&#39;</span>:
<a name="l01230"></a>01230                 $node-&gt;_[<a class="code" href="simple__html__dom_8php.html#a1b5b6bdcc0c5597e0e9f0f881ff9ab3c">HDOM_INFO_QUOTE</a>][] = <a class="code" href="simple__html__dom_8php.html#a25b2e9df879f0e9e6c19a2b1a0560270">HDOM_QUOTE_DOUBLE</a>;
<a name="l01231"></a>01231                 $this-&gt;<span class="keywordtype">char</span> = (++$this-&gt;pos&lt;$this-&gt;size) ? $this-&gt;doc[$this-&gt;pos] : null; <span class="comment">// next</span>
<a name="l01232"></a>01232                 $node-&gt;attr[$name] = $this-&gt;<a class="code" href="classsimple__html__dom.html#a65768af772cc55c11fc85d4d8697140e">restore_noise</a>($this-&gt;<a class="code" href="classsimple__html__dom.html#a2df9f8464f8daf439f9fa740ebdc0ede">copy_until_char_escape</a>(<span class="charliteral">&#39;&quot;&#39;</span>));
<a name="l01233"></a>01233                 $this-&gt;<span class="keywordtype">char</span> = (++$this-&gt;pos&lt;$this-&gt;size) ? $this-&gt;doc[$this-&gt;pos] : null; <span class="comment">// next</span>
<a name="l01234"></a>01234                 <span class="keywordflow">break</span>;
<a name="l01235"></a>01235             <span class="keywordflow">case</span> <span class="charliteral">&#39;\&#39;&#39;</span>:
<a name="l01236"></a>01236                 $node-&gt;_[<a class="code" href="simple__html__dom_8php.html#a1b5b6bdcc0c5597e0e9f0f881ff9ab3c">HDOM_INFO_QUOTE</a>][] = <a class="code" href="simple__html__dom_8php.html#a6c2fdccdefefb69968227c6c3ec6611a">HDOM_QUOTE_SINGLE</a>;
<a name="l01237"></a>01237                 $this-&gt;<span class="keywordtype">char</span> = (++$this-&gt;pos&lt;$this-&gt;size) ? $this-&gt;doc[$this-&gt;pos] : null; <span class="comment">// next</span>
<a name="l01238"></a>01238                 $node-&gt;attr[$name] = $this-&gt;<a class="code" href="classsimple__html__dom.html#a65768af772cc55c11fc85d4d8697140e">restore_noise</a>($this-&gt;<a class="code" href="classsimple__html__dom.html#a2df9f8464f8daf439f9fa740ebdc0ede">copy_until_char_escape</a>(<span class="charliteral">&#39;\&#39;&#39;</span>));
<a name="l01239"></a>01239                 $this-&gt;<span class="keywordtype">char</span> = (++$this-&gt;pos&lt;$this-&gt;size) ? $this-&gt;doc[$this-&gt;pos] : null; <span class="comment">// next</span>
<a name="l01240"></a>01240                 <span class="keywordflow">break</span>;
<a name="l01241"></a>01241             <span class="keywordflow">default</span>:
<a name="l01242"></a>01242                 $node-&gt;_[<a class="code" href="simple__html__dom_8php.html#a1b5b6bdcc0c5597e0e9f0f881ff9ab3c">HDOM_INFO_QUOTE</a>][] = <a class="code" href="simple__html__dom_8php.html#ad587bc18546aacd6ec20b68dc1ef9379">HDOM_QUOTE_NO</a>;
<a name="l01243"></a>01243                 $node-&gt;attr[$name] = $this-&gt;<a class="code" href="classsimple__html__dom.html#a65768af772cc55c11fc85d4d8697140e">restore_noise</a>($this-&gt;<a class="code" href="classsimple__html__dom.html#a607299237161af9369abc2d2605715d5">copy_until</a>($this-&gt;token_attr));
<a name="l01244"></a>01244         }
<a name="l01245"></a>01245         <span class="comment">// PaperG: Attributes should not have \r or \n in them, that counts as html whitespace.</span>
<a name="l01246"></a>01246         $node-&gt;attr[$name] = str_replace(<span class="stringliteral">&quot;\r&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, $node-&gt;attr[$name]);
<a name="l01247"></a>01247         $node-&gt;attr[$name] = str_replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, $node-&gt;attr[$name]);
<a name="l01248"></a>01248         <span class="comment">// PaperG: If this is a &quot;class&quot; selector, lets get rid of the preceeding and trailing space since some people leave it in the multi class case.</span>
<a name="l01249"></a>01249         <span class="keywordflow">if</span> ($name == <span class="stringliteral">&quot;class&quot;</span>) {
<a name="l01250"></a>01250             $node-&gt;attr[$name] = trim($node-&gt;attr[$name]);
<a name="l01251"></a>01251         }
<a name="l01252"></a>01252     }
<a name="l01253"></a>01253 
<a name="l01254"></a>01254     <span class="comment">// link node&#39;s parent</span>
<a name="l01255"></a><a class="code" href="classsimple__html__dom.html#a19edb141f64d5d085874f2e75e0aa333">01255</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a19edb141f64d5d085874f2e75e0aa333">link_nodes</a>(&amp;$node, $is_child) {
<a name="l01256"></a>01256         $node-&gt;parent = $this-&gt;parent;
<a name="l01257"></a>01257         $this-&gt;parent-&gt;nodes[] = $node;
<a name="l01258"></a>01258         <span class="keywordflow">if</span> ($is_child)
<a name="l01259"></a>01259             $this-&gt;parent-&gt;children[] = $node;
<a name="l01260"></a>01260     }
<a name="l01261"></a>01261 
<a name="l01262"></a>01262     <span class="comment">// as a text node</span>
<a name="l01263"></a><a class="code" href="classsimple__html__dom.html#a17ff0dd434a94d34972e3c90fbd0d545">01263</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a17ff0dd434a94d34972e3c90fbd0d545">as_text_node</a>($tag) {
<a name="l01264"></a>01264         $node = <span class="keyword">new</span> <a class="code" href="classsimple__html__dom__node.html">simple_html_dom_node</a>($this);
<a name="l01265"></a>01265         ++$this-&gt;cursor;
<a name="l01266"></a>01266         $node-&gt;_[<a class="code" href="simple__html__dom_8php.html#a9750656802ea115d7b3797e22cf2f07e">HDOM_INFO_TEXT</a>] = <span class="stringliteral">&#39;&lt;/&#39;</span> . $tag . <span class="charliteral">&#39;&gt;&#39;</span>;
<a name="l01267"></a>01267         $this-&gt;<a class="code" href="classsimple__html__dom.html#a19edb141f64d5d085874f2e75e0aa333">link_nodes</a>($node, <span class="keyword">false</span>);
<a name="l01268"></a>01268         $this-&gt;<span class="keywordtype">char</span> = (++$this-&gt;pos&lt;$this-&gt;size) ? $this-&gt;doc[$this-&gt;pos] : null; <span class="comment">// next</span>
<a name="l01269"></a>01269         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01270"></a>01270     }
<a name="l01271"></a>01271 
<a name="l01272"></a><a class="code" href="classsimple__html__dom.html#a83de9b35df2e0857f2b0be5bff3e4960">01272</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a83de9b35df2e0857f2b0be5bff3e4960">skip</a>($chars) {
<a name="l01273"></a>01273         $this-&gt;pos += strspn($this-&gt;doc, $chars, $this-&gt;pos);
<a name="l01274"></a>01274         $this-&gt;<span class="keywordtype">char</span> = ($this-&gt;pos&lt;$this-&gt;size) ? $this-&gt;doc[$this-&gt;pos] : null; <span class="comment">// next</span>
<a name="l01275"></a>01275     }
<a name="l01276"></a>01276 
<a name="l01277"></a><a class="code" href="classsimple__html__dom.html#a48081dad72c2e828f05ae7420d95c820">01277</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a48081dad72c2e828f05ae7420d95c820">copy_skip</a>($chars) {
<a name="l01278"></a>01278         <a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> = $this-&gt;pos;
<a name="l01279"></a>01279         $len = strspn($this-&gt;doc, $chars, <a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>);
<a name="l01280"></a>01280         $this-&gt;pos += $len;
<a name="l01281"></a>01281         $this-&gt;<span class="keywordtype">char</span> = ($this-&gt;pos&lt;$this-&gt;size) ? $this-&gt;doc[$this-&gt;pos] : null; <span class="comment">// next</span>
<a name="l01282"></a>01282         <span class="keywordflow">if</span> ($len===0) <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;
<a name="l01283"></a>01283         <span class="keywordflow">return</span> substr($this-&gt;doc, <a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>, $len);
<a name="l01284"></a>01284     }
<a name="l01285"></a>01285 
<a name="l01286"></a><a class="code" href="classsimple__html__dom.html#a607299237161af9369abc2d2605715d5">01286</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a607299237161af9369abc2d2605715d5">copy_until</a>($chars) {
<a name="l01287"></a>01287         <a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> = $this-&gt;pos;
<a name="l01288"></a>01288         $len = strcspn($this-&gt;doc, $chars, <a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>);
<a name="l01289"></a>01289         $this-&gt;pos += $len;
<a name="l01290"></a>01290         $this-&gt;<span class="keywordtype">char</span> = ($this-&gt;pos&lt;$this-&gt;size) ? $this-&gt;doc[$this-&gt;pos] : null; <span class="comment">// next</span>
<a name="l01291"></a>01291         <span class="keywordflow">return</span> substr($this-&gt;doc, <a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>, $len);
<a name="l01292"></a>01292     }
<a name="l01293"></a>01293 
<a name="l01294"></a><a class="code" href="classsimple__html__dom.html#a0dcd73e05f3cee1eafe3ec6fa347c36b">01294</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a0dcd73e05f3cee1eafe3ec6fa347c36b">copy_until_char</a>(<a class="code" href="classsimple__html__dom.html#a128242871482e787498df34c33223f14">$char</a>) {
<a name="l01295"></a>01295         <span class="keywordflow">if</span> ($this-&gt;<span class="keywordtype">char</span>===null) <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;
<a name="l01296"></a>01296 
<a name="l01297"></a>01297         <span class="keywordflow">if</span> ((<a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> = strpos($this-&gt;doc, <a class="code" href="classsimple__html__dom.html#a128242871482e787498df34c33223f14">$char</a>, $this-&gt;pos))===<span class="keyword">false</span>) {
<a name="l01298"></a>01298             $ret = substr($this-&gt;doc, $this-&gt;pos, $this-&gt;size-$this-&gt;pos);
<a name="l01299"></a>01299             $this-&gt;<span class="keywordtype">char</span> = null;
<a name="l01300"></a>01300             $this-&gt;pos = $this-&gt;size;
<a name="l01301"></a>01301             <span class="keywordflow">return</span> $ret;
<a name="l01302"></a>01302         }
<a name="l01303"></a>01303 
<a name="l01304"></a>01304         <span class="keywordflow">if</span> (<a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>===$this-&gt;pos) <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;
<a name="l01305"></a>01305         $pos_old = $this-&gt;pos;
<a name="l01306"></a>01306         $this-&gt;<span class="keywordtype">char</span> = $this-&gt;doc[<a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>];
<a name="l01307"></a>01307         $this-&gt;pos = <a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>;
<a name="l01308"></a>01308         <span class="keywordflow">return</span> substr($this-&gt;doc, $pos_old, <a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>-$pos_old);
<a name="l01309"></a>01309     }
<a name="l01310"></a>01310 
<a name="l01311"></a><a class="code" href="classsimple__html__dom.html#a2df9f8464f8daf439f9fa740ebdc0ede">01311</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a2df9f8464f8daf439f9fa740ebdc0ede">copy_until_char_escape</a>(<a class="code" href="classsimple__html__dom.html#a128242871482e787498df34c33223f14">$char</a>) {
<a name="l01312"></a>01312         <span class="keywordflow">if</span> ($this-&gt;<span class="keywordtype">char</span>===null) <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;
<a name="l01313"></a>01313 
<a name="l01314"></a>01314         $start = $this-&gt;pos;
<a name="l01315"></a>01315         <span class="keywordflow">while</span> (1) {
<a name="l01316"></a>01316             <span class="keywordflow">if</span> ((<a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> = strpos($this-&gt;doc, <a class="code" href="classsimple__html__dom.html#a128242871482e787498df34c33223f14">$char</a>, $start))===<span class="keyword">false</span>) {
<a name="l01317"></a>01317                 $ret = substr($this-&gt;doc, $this-&gt;pos, $this-&gt;size-$this-&gt;pos);
<a name="l01318"></a>01318                 $this-&gt;<span class="keywordtype">char</span> = null;
<a name="l01319"></a>01319                 $this-&gt;pos = $this-&gt;size;
<a name="l01320"></a>01320                 <span class="keywordflow">return</span> $ret;
<a name="l01321"></a>01321             }
<a name="l01322"></a>01322 
<a name="l01323"></a>01323             <span class="keywordflow">if</span> (<a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>===$this-&gt;pos) <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;
<a name="l01324"></a>01324 
<a name="l01325"></a>01325             <span class="keywordflow">if</span> ($this-&gt;doc[<a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>-1]===<span class="charliteral">&#39;\\&#39;</span>) {
<a name="l01326"></a>01326                 $start = <a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>+1;
<a name="l01327"></a>01327                 <span class="keywordflow">continue</span>;
<a name="l01328"></a>01328             }
<a name="l01329"></a>01329 
<a name="l01330"></a>01330             $pos_old = $this-&gt;pos;
<a name="l01331"></a>01331             $this-&gt;<span class="keywordtype">char</span> = $this-&gt;doc[<a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>];
<a name="l01332"></a>01332             $this-&gt;pos = <a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>;
<a name="l01333"></a>01333             <span class="keywordflow">return</span> substr($this-&gt;doc, $pos_old, <a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>-$pos_old);
<a name="l01334"></a>01334         }
<a name="l01335"></a>01335     }
<a name="l01336"></a>01336 
<a name="l01337"></a>01337     <span class="comment">// remove noise from html content</span>
<a name="l01338"></a><a class="code" href="classsimple__html__dom.html#a5bf6f05cd9b47a87912de85a6a556b6b">01338</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a5bf6f05cd9b47a87912de85a6a556b6b">remove_noise</a>($pattern, $remove_tag=<span class="keyword">false</span>) {
<a name="l01339"></a>01339         $count = preg_match_all($pattern, $this-&gt;doc, $matches, PREG_SET_ORDER|PREG_OFFSET_CAPTURE);
<a name="l01340"></a>01340 
<a name="l01341"></a>01341         <span class="keywordflow">for</span> ($i=$count-1; $i&gt;-1; --$i) {
<a name="l01342"></a>01342             $key = <span class="stringliteral">&#39;___noise___&#39;</span>.sprintf(<span class="stringliteral">&#39;% 3d&#39;</span>, count($this-&gt;noise)+100);
<a name="l01343"></a>01343             $idx = ($remove_tag) ? 0 : 1;
<a name="l01344"></a>01344             $this-&gt;noise[$key] = $matches[$i][$idx][0];
<a name="l01345"></a>01345             $this-&gt;doc = substr_replace($this-&gt;doc, $key, $matches[$i][$idx][1], strlen($matches[$i][$idx][0]));
<a name="l01346"></a>01346         }
<a name="l01347"></a>01347 
<a name="l01348"></a>01348         <span class="comment">// reset the length of content</span>
<a name="l01349"></a>01349         $this-&gt;size = strlen($this-&gt;doc);
<a name="l01350"></a>01350         <span class="keywordflow">if</span> ($this-&gt;size&gt;0) $this-&gt;<span class="keywordtype">char</span> = $this-&gt;doc[0];
<a name="l01351"></a>01351     }
<a name="l01352"></a>01352 
<a name="l01353"></a>01353     <span class="comment">// restore noise to html content</span>
<a name="l01354"></a><a class="code" href="classsimple__html__dom.html#a65768af772cc55c11fc85d4d8697140e">01354</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a65768af772cc55c11fc85d4d8697140e">restore_noise</a>($text) {
<a name="l01355"></a>01355         <span class="keywordflow">while</span> ((<a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>=strpos($text, <span class="stringliteral">&#39;___noise___&#39;</span>))!==<span class="keyword">false</span>) {
<a name="l01356"></a>01356             $key = <span class="stringliteral">&#39;___noise___&#39;</span>.$text[<a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>+11].$text[<a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>+12].$text[<a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>+13];
<a name="l01357"></a>01357             <span class="keywordflow">if</span> (isset($this-&gt;noise[$key]))
<a name="l01358"></a>01358                 $text = substr($text, 0, <a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>).$this-&gt;noise[$key].substr($text, <a class="code" href="classsimple__html__dom.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>+14);
<a name="l01359"></a>01359         }
<a name="l01360"></a>01360         <span class="keywordflow">return</span> $text;
<a name="l01361"></a>01361     }
<a name="l01362"></a>01362 
<a name="l01363"></a><a class="code" href="classsimple__html__dom.html#a7516ca30af0db3cdbf9a7739b48ce91d">01363</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a7516ca30af0db3cdbf9a7739b48ce91d">__toString</a>() {
<a name="l01364"></a>01364         <span class="keywordflow">return</span> $this-&gt;root-&gt;innertext();
<a name="l01365"></a>01365     }
<a name="l01366"></a>01366 
<a name="l01367"></a><a class="code" href="classsimple__html__dom.html#abc8e9e31bb15c8a44c3210ec551407c8">01367</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#abc8e9e31bb15c8a44c3210ec551407c8">__get</a>($name) {
<a name="l01368"></a>01368         <span class="keywordflow">switch</span> ($name) {
<a name="l01369"></a>01369             <span class="keywordflow">case</span> <span class="stringliteral">&#39;outertext&#39;</span>:
<a name="l01370"></a>01370                 <span class="keywordflow">return</span> $this-&gt;root-&gt;innertext();
<a name="l01371"></a>01371             <span class="keywordflow">case</span> <span class="stringliteral">&#39;innertext&#39;</span>:
<a name="l01372"></a>01372                 <span class="keywordflow">return</span> $this-&gt;root-&gt;innertext();
<a name="l01373"></a>01373             <span class="keywordflow">case</span> <span class="stringliteral">&#39;plaintext&#39;</span>:
<a name="l01374"></a>01374                 <span class="keywordflow">return</span> $this-&gt;root-&gt;text();
<a name="l01375"></a>01375             <span class="keywordflow">case</span> <span class="stringliteral">&#39;charset&#39;</span>:
<a name="l01376"></a>01376                 <span class="keywordflow">return</span> $this-&gt;_charset;
<a name="l01377"></a>01377             <span class="keywordflow">case</span> <span class="stringliteral">&#39;target_charset&#39;</span>:
<a name="l01378"></a>01378                 <span class="keywordflow">return</span> $this-&gt;_target_charset;
<a name="l01379"></a>01379         }
<a name="l01380"></a>01380     }
<a name="l01381"></a>01381 
<a name="l01382"></a>01382     <span class="comment">// camel naming conventions</span>
<a name="l01383"></a><a class="code" href="classsimple__html__dom.html#a543b9f022b4d71d19a8f055b3b87bb77">01383</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a543b9f022b4d71d19a8f055b3b87bb77">childNodes</a>($idx=-1) {<span class="keywordflow">return</span> $this-&gt;root-&gt;childNodes($idx);}
<a name="l01384"></a><a class="code" href="classsimple__html__dom.html#a2e7ff3e4db465652634f86004ccb83db">01384</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a2e7ff3e4db465652634f86004ccb83db">firstChild</a>() {<span class="keywordflow">return</span> $this-&gt;root-&gt;first_child();}
<a name="l01385"></a><a class="code" href="classsimple__html__dom.html#aa290d153aa9b41988d2b4bfb23424241">01385</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#aa290d153aa9b41988d2b4bfb23424241">lastChild</a>() {<span class="keywordflow">return</span> $this-&gt;root-&gt;last_child();}
<a name="l01386"></a><a class="code" href="classsimple__html__dom.html#aec6ca41b9859728595ece521ca638e48">01386</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#aec6ca41b9859728595ece521ca638e48">getElementById</a>($id) {<span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom.html#afbf375e355aa32c25f7e389a04ddced0">find</a>(<span class="stringliteral">&quot;#$id&quot;</span>, 0);}
<a name="l01387"></a><a class="code" href="classsimple__html__dom.html#a12433180a44804217a6089284c1e337a">01387</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a12433180a44804217a6089284c1e337a">getElementsById</a>($id, $idx=null) {<span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom.html#afbf375e355aa32c25f7e389a04ddced0">find</a>(<span class="stringliteral">&quot;#$id&quot;</span>, $idx);}
<a name="l01388"></a><a class="code" href="classsimple__html__dom.html#a73eb6caf89c86044a5ed0092484f375d">01388</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a73eb6caf89c86044a5ed0092484f375d">getElementByTagName</a>($name) {<span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom.html#afbf375e355aa32c25f7e389a04ddced0">find</a>($name, 0);}
<a name="l01389"></a><a class="code" href="classsimple__html__dom.html#a3f59e79eb934dd4d4ef322f20d368849">01389</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a3f59e79eb934dd4d4ef322f20d368849">getElementsByTagName</a>($name, $idx=-1) {<span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsimple__html__dom.html#afbf375e355aa32c25f7e389a04ddced0">find</a>($name, $idx);}
<a name="l01390"></a><a class="code" href="classsimple__html__dom.html#a4ab90327dc2941e600549ddf19e75bbd">01390</a>     <span class="keyword">function</span> <a class="code" href="classsimple__html__dom.html#a4ab90327dc2941e600549ddf19e75bbd">loadFile</a>() {$args = func_get_args();$this-&gt;<a class="code" href="classsimple__html__dom.html#acbf45344758b1a521534cc9cc8ebc5f5">load_file</a>($args);}
<a name="l01391"></a>01391 }
<a name="l01392"></a>01392 
<a name="l01393"></a>01393 ?&gt;
</pre></div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>Tout</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Structures de données</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Espaces de nommage</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Fichiers</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Fonctions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Énumérations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="simple__html__dom_8php.html">simple_html_dom.php</a>      </li>

    <li class="footer">Généré le Jeudi Mai 17 2012 16:28:58 pour Nina par
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
